/*
 * DO NOT EDIT THIS FILE - it is generated by Glade.
 */

#ifdef HAVE_CONFIG_H
#  include <config.h>
#endif

#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
#include <string.h>
#include <stdio.h>

#include <gdk/gdkkeysyms.h>
#include <gtk/gtk.h>

#include "callbacks.h"
#include "interface.h"
#include "support.h"


extern	guint8	 	k_tuples;				
extern	guint8		windows_size;			
extern	guint16		map_length;				
extern	guint32		map_square;			
extern	guint8		reading_mode;		
extern	gboolean	randomization;		
extern	guint8		rand_times;			
extern	guint8		color_mode;			
extern	gboolean	comparation_reduction;  
extern	guint8		comparation_DAN;		
extern	guint8		exp_table[11];
extern	gfloat		color_high[16][3];
extern	gfloat		color_auto[16][3];
extern	guint8		drawing_mode;			

#define GLADE_HOOKUP_OBJECT(component,widget,name) \
  g_object_set_data_full (G_OBJECT (component), name, \
    gtk_widget_ref (widget), (GDestroyNotify) gtk_widget_unref)

#define GLADE_HOOKUP_OBJECT_NO_REF(component,widget,name) \
  g_object_set_data (G_OBJECT (component), name, widget)

GtkWidget*
create_console (void)
{
  GtkWidget *console;
  GtkWidget *advancedsettings;
  GtkWidget *portrait;
  GtkWidget *histogram;
  GtkWidget *about;
  
  GtkWidget *vbox_console;

  GtkWidget *menubar1;
  GtkWidget *menuitem1;
  GtkWidget *menu1;
  GtkWidget *open1;
  GtkWidget *close1;
  GtkWidget *separatormenuitem1;
  GtkWidget *quit1;
  GtkWidget *menuitem2;
  GtkWidget *menu2;
  GtkWidget *settings1;
  GtkWidget *menuitem3;
  GtkWidget *menu3;
  GtkWidget *about1;
  
  GtkWidget *fixed_console;
  GtkWidget *scrolledwindow_console_file;
  GtkWidget *clist_console_sequencefile;
  GtkWidget *label_console_sequencefile_locus;
  GtkWidget *label_console_sequencefile_description;
  GtkWidget *label_console_sequencefile_format;
  GtkWidget *label_console_sequencefile_filepath;
  GtkWidget *frame_console_seqinfo;
  GtkWidget *scrolledwindow_console_seqinfo;
  GtkWidget *textview_console_seqinfo;
  GtkWidget *label_console_seqinfo;
  GtkWidget *frame_console_drawingpanel;
  GtkWidget *fixed_console_drawingpanel;
  GtkWidget *button_console_drawingpanel_histogram;
  GtkWidget *button_console_drawingpanel_portrait;
  GtkWidget *label_console_drawingpanel;
  GtkWidget *frame_console_settings;
  GtkWidget *fixed_console_settings;
  GtkWidget *frame_console_colormode;
  GtkWidget *drawingarea_console_colormode;
  GtkWidget *label_console_colormode;
  GtkWidget *frame_console_randomiztion;
  GtkWidget *fixed_console_randomization;
  GtkWidget *radiobutton_console_randomization_none;
  GSList *radiobutton_console_randomization_none_group = NULL;
  GtkWidget *radiobutton_console_randomization_applicated;
  GtkWidget *label_console_randomization;
  GtkWidget *frame_console_readingmethod;
  GtkWidget *fixed_console_readingmethod;
  GtkWidget *radiobutton_console_readingmethod_original;
  GSList *radiobutton_console_readingmethod_original_group = NULL;
  GtkWidget *radiobutton_console_readingmethod_reverse;
  GtkWidget *radiobutton_console_readingmethod_originalandreverse;
  GtkWidget *label_console_readingmethod;
  GtkWidget *frame_console_ktuples;
  GtkWidget *fixed_console_ktuples;
  GtkObject *spinbutton_console_ktuples_adj;
  GtkWidget *spinbutton_console_ktuples;
  GtkWidget *label_console_ktuples_K;
  GtkWidget *label_console_ktuples;
  GtkWidget *button_console_advancedsettings;
  GtkWidget *alignment1;
  GtkWidget *hbox4;
  GtkWidget *image_console_advancedsettings;
  GtkWidget *label_console_advancedsettings;
  GtkWidget *label_console_settings;
  GtkWidget *statusbar_console;
  GtkAccelGroup *accel_group;

  accel_group = gtk_accel_group_new ();

  console = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_window_set_title (GTK_WINDOW (console), _("SeeDNA 1.0"));
  gtk_window_set_position (GTK_WINDOW (console), GTK_WIN_POS_CENTER);
  gtk_window_set_default_size (GTK_WINDOW (console), 640, 600);
  gtk_window_set_resizable (GTK_WINDOW (console), FALSE);

  vbox_console = gtk_vbox_new (FALSE, 0);
  gtk_widget_show (vbox_console);
  gtk_container_add (GTK_CONTAINER (console), vbox_console);

  menubar1 = gtk_menu_bar_new ();
  gtk_widget_show (menubar1);
  gtk_box_pack_start (GTK_BOX (vbox_console), menubar1, FALSE, FALSE, 0);

  menuitem1 = gtk_menu_item_new_with_mnemonic (_("_File"));
  gtk_widget_show (menuitem1);
  gtk_container_add (GTK_CONTAINER (menubar1), menuitem1);

  menu1 = gtk_menu_new ();
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (menuitem1), menu1);

  open1 = gtk_image_menu_item_new_from_stock ("gtk-open", accel_group);
  gtk_widget_show (open1);
  gtk_container_add (GTK_CONTAINER (menu1), open1);

//// new menu item added 2004.3.4 ////
  close1 = gtk_image_menu_item_new_from_stock ("gtk-close", accel_group);
  gtk_widget_show (close1);
  gtk_container_add (GTK_CONTAINER (menu1), close1);
////
  
  separatormenuitem1 = gtk_separator_menu_item_new ();
  gtk_widget_show (separatormenuitem1);
  gtk_container_add (GTK_CONTAINER (menu1), separatormenuitem1);
  gtk_widget_set_sensitive (separatormenuitem1, FALSE);

  quit1 = gtk_image_menu_item_new_from_stock ("gtk-quit", accel_group);
  gtk_widget_show (quit1);
  gtk_container_add (GTK_CONTAINER (menu1), quit1);

  menuitem2 = gtk_menu_item_new_with_mnemonic (_("_Configure"));
  gtk_widget_show (menuitem2);
  gtk_container_add (GTK_CONTAINER (menubar1), menuitem2);

  menu2 = gtk_menu_new ();
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (menuitem2), menu2);

  settings1 = gtk_image_menu_item_new_from_stock ("Advanced Settings", accel_group);
  gtk_widget_show (settings1);
  gtk_container_add (GTK_CONTAINER (menu2), settings1);

  menuitem3 = gtk_menu_item_new_with_mnemonic (_("_Help"));
  gtk_widget_show (menuitem3);
  gtk_container_add (GTK_CONTAINER (menubar1), menuitem3);

  menu3 = gtk_menu_new ();
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (menuitem3), menu3);

  about1 = gtk_menu_item_new_with_mnemonic (_("_About"));
  gtk_widget_show (about1);
  gtk_container_add (GTK_CONTAINER (menu3), about1);

//// add accel to current window 2004.3.4 ////
  gtk_window_add_accel_group (GTK_WINDOW (console), accel_group);
////
 
  fixed_console = gtk_fixed_new ();
  gtk_widget_show (fixed_console);
  gtk_box_pack_start (GTK_BOX (vbox_console), fixed_console, TRUE, TRUE, 0);

  scrolledwindow_console_file = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_show (scrolledwindow_console_file);
  gtk_fixed_put (GTK_FIXED (fixed_console), scrolledwindow_console_file, 0, 0);
  gtk_widget_set_size_request (scrolledwindow_console_file, 640, 200);
  gtk_container_set_border_width (GTK_CONTAINER (scrolledwindow_console_file), 5);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow_console_file), GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);

  clist_console_sequencefile = gtk_clist_new (4);
  gtk_widget_show (clist_console_sequencefile);
  gtk_container_add (GTK_CONTAINER (scrolledwindow_console_file), clist_console_sequencefile);
  gtk_widget_set_events (clist_console_sequencefile, GDK_BUTTON_PRESS_MASK);
  gtk_clist_set_column_width (GTK_CLIST (clist_console_sequencefile), 0, 100);
  gtk_clist_set_column_width (GTK_CLIST (clist_console_sequencefile), 1, 300);
  gtk_clist_set_column_width (GTK_CLIST (clist_console_sequencefile), 2, 63);
  gtk_clist_set_column_width (GTK_CLIST (clist_console_sequencefile), 3, 65);
  gtk_clist_column_titles_show (GTK_CLIST (clist_console_sequencefile));

  label_console_sequencefile_locus = gtk_label_new (_("LOCUS"));
  gtk_widget_show (label_console_sequencefile_locus);
  gtk_clist_set_column_widget (GTK_CLIST (clist_console_sequencefile), 0, label_console_sequencefile_locus);
  gtk_label_set_justify (GTK_LABEL (label_console_sequencefile_locus), GTK_JUSTIFY_LEFT);

  label_console_sequencefile_description = gtk_label_new (_("Description"));
  gtk_widget_show (label_console_sequencefile_description);
  gtk_clist_set_column_widget (GTK_CLIST (clist_console_sequencefile), 1, label_console_sequencefile_description);
  gtk_label_set_justify (GTK_LABEL (label_console_sequencefile_description), GTK_JUSTIFY_LEFT);

  label_console_sequencefile_format = gtk_label_new (_("Format"));
  gtk_widget_show (label_console_sequencefile_format);
  gtk_clist_set_column_widget (GTK_CLIST (clist_console_sequencefile), 2, label_console_sequencefile_format);
  gtk_label_set_justify (GTK_LABEL (label_console_sequencefile_format), GTK_JUSTIFY_LEFT);

  label_console_sequencefile_filepath = gtk_label_new (_("File Path"));
  gtk_widget_show (label_console_sequencefile_filepath);
  gtk_clist_set_column_widget (GTK_CLIST (clist_console_sequencefile), 3, label_console_sequencefile_filepath);
  gtk_label_set_justify (GTK_LABEL (label_console_sequencefile_filepath), GTK_JUSTIFY_LEFT);

  frame_console_seqinfo = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_seqinfo);
  gtk_fixed_put (GTK_FIXED (fixed_console), frame_console_seqinfo, 5, 200);
  gtk_widget_set_size_request (frame_console_seqinfo, 300, 229);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_seqinfo), 0.5, 0.5);

  scrolledwindow_console_seqinfo = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_show (scrolledwindow_console_seqinfo);
  gtk_container_add (GTK_CONTAINER (frame_console_seqinfo), scrolledwindow_console_seqinfo);
  gtk_container_set_border_width (GTK_CONTAINER (scrolledwindow_console_seqinfo), 5);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow_console_seqinfo), GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);
  gtk_scrolled_window_set_shadow_type (GTK_SCROLLED_WINDOW (scrolledwindow_console_seqinfo), GTK_SHADOW_OUT);

  textview_console_seqinfo = gtk_text_view_new ();
  gtk_widget_show (textview_console_seqinfo);
  gtk_container_add (GTK_CONTAINER (scrolledwindow_console_seqinfo), textview_console_seqinfo);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_console_seqinfo), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_console_seqinfo), FALSE);
  gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (textview_console_seqinfo)),
	_("This window will display the information\n of selected sequence."), -1);

  label_console_seqinfo = gtk_label_new (_("Sequence Information"));
  gtk_widget_show (label_console_seqinfo);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_seqinfo), label_console_seqinfo);
  gtk_label_set_justify (GTK_LABEL (label_console_seqinfo), GTK_JUSTIFY_LEFT);

  frame_console_drawingpanel = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_drawingpanel);
  gtk_fixed_put (GTK_FIXED (fixed_console), frame_console_drawingpanel, 310, 379);
  gtk_widget_set_size_request (frame_console_drawingpanel, 325, 50);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_drawingpanel), 0.5, 0.5);

  fixed_console_drawingpanel = gtk_fixed_new ();
  gtk_widget_show (fixed_console_drawingpanel);
  gtk_container_add (GTK_CONTAINER (frame_console_drawingpanel), fixed_console_drawingpanel);

  button_console_drawingpanel_histogram = gtk_button_new_with_mnemonic (_("1D Histogram"));
  gtk_widget_show (button_console_drawingpanel_histogram);
  gtk_fixed_put (GTK_FIXED (fixed_console_drawingpanel), button_console_drawingpanel_histogram, 182, 0);
  gtk_widget_set_size_request (button_console_drawingpanel_histogram, 120, 26);

  button_console_drawingpanel_portrait = gtk_button_new_with_mnemonic (_("2D Portrait"));
  gtk_widget_show (button_console_drawingpanel_portrait);
  gtk_fixed_put (GTK_FIXED (fixed_console_drawingpanel), button_console_drawingpanel_portrait, 24, 0);
  gtk_widget_set_size_request (button_console_drawingpanel_portrait, 120, 26);

  label_console_drawingpanel = gtk_label_new (_("Drawing Panel"));
  gtk_widget_show (label_console_drawingpanel);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_drawingpanel), label_console_drawingpanel);
  gtk_label_set_justify (GTK_LABEL (label_console_drawingpanel), GTK_JUSTIFY_LEFT);

  frame_console_settings = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_settings);
  gtk_fixed_put (GTK_FIXED (fixed_console), frame_console_settings, 310, 200);
  gtk_widget_set_size_request (frame_console_settings, 325, 180);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_settings), 0.5, 0.5);

  fixed_console_settings = gtk_fixed_new ();
  gtk_widget_show (fixed_console_settings);
  gtk_container_add (GTK_CONTAINER (frame_console_settings), fixed_console_settings);

  frame_console_colormode = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_console_settings), frame_console_colormode, 5, 115);
  gtk_widget_set_size_request (frame_console_colormode, 200, 46);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_colormode), 0.5, 0.5);

  drawingarea_console_colormode = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_console_colormode);
  gtk_container_add (GTK_CONTAINER (frame_console_colormode), drawingarea_console_colormode);

  char *colorlist	=	(char*)malloc(192*20*4*2);
  if(colorlist==NULL){
   	Memory_Error();
   	exit(1);
  }
  int colornumber=0,n,m;
  for(colornumber=0;colornumber<16;colornumber++)
  {
	 for(n=0;n<20;n++){
		for(m=0;m<36;m++){
			colorlist[(n*192+m/3+colornumber*12)*4+m%3]	= color_high[colornumber][m%3]*255;
			colorlist[(n*192+m/3+colornumber*12)*4+192*20*4+m%3]= color_auto[colornumber][m%3]*255;
		}
	 } 
  }

  label_console_colormode = gtk_label_new (_("Color Code"));
  gtk_widget_show (label_console_colormode);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_colormode), label_console_colormode);
  gtk_label_set_justify (GTK_LABEL (label_console_colormode), GTK_JUSTIFY_LEFT);

  frame_console_randomiztion = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_randomiztion);
  gtk_fixed_put (GTK_FIXED (fixed_console_settings), frame_console_randomiztion, 5, 52);
  gtk_widget_set_size_request (frame_console_randomiztion, 138, 66);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_randomiztion), 0.5, 0.5);

  fixed_console_randomization = gtk_fixed_new ();
  gtk_widget_show (fixed_console_randomization);
  gtk_container_add (GTK_CONTAINER (frame_console_randomiztion), fixed_console_randomization);

  radiobutton_console_randomization_none = gtk_radio_button_new_with_mnemonic (NULL, _("None"));
  gtk_widget_show (radiobutton_console_randomization_none);
  gtk_fixed_put (GTK_FIXED (fixed_console_randomization), radiobutton_console_randomization_none, 5, 0);
  gtk_widget_set_size_request (radiobutton_console_randomization_none, 120, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_console_randomization_none), radiobutton_console_randomization_none_group);
  radiobutton_console_randomization_none_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_console_randomization_none));

  radiobutton_console_randomization_applicated = gtk_radio_button_new_with_mnemonic (NULL, _("Apply"));
  gtk_widget_show (radiobutton_console_randomization_applicated);
  gtk_fixed_put (GTK_FIXED (fixed_console_randomization), radiobutton_console_randomization_applicated, 5, 24);
  gtk_widget_set_size_request (radiobutton_console_randomization_applicated, 120, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_console_randomization_applicated), radiobutton_console_randomization_none_group);
  radiobutton_console_randomization_none_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_console_randomization_applicated));

  label_console_randomization = gtk_label_new (_("Randomization"));
  gtk_widget_show (label_console_randomization);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_randomiztion), label_console_randomization);
  gtk_label_set_justify (GTK_LABEL (label_console_randomization), GTK_JUSTIFY_LEFT);

  frame_console_readingmethod = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_readingmethod);
  gtk_fixed_put (GTK_FIXED (fixed_console_settings), frame_console_readingmethod, 152, 0);
  gtk_widget_set_size_request (frame_console_readingmethod, 165, 118);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_readingmethod), 0.51, 0.5);

  fixed_console_readingmethod = gtk_fixed_new ();
  gtk_widget_show (fixed_console_readingmethod);
  gtk_container_add (GTK_CONTAINER (frame_console_readingmethod), fixed_console_readingmethod);

  radiobutton_console_readingmethod_original = gtk_radio_button_new_with_mnemonic (NULL, _("Original"));
  gtk_widget_show (radiobutton_console_readingmethod_original);
  gtk_fixed_put (GTK_FIXED (fixed_console_readingmethod), radiobutton_console_readingmethod_original, 16, 8);
  gtk_widget_set_size_request (radiobutton_console_readingmethod_original, 130, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_original), radiobutton_console_readingmethod_original_group);
  radiobutton_console_readingmethod_original_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_original));

  radiobutton_console_readingmethod_reverse = gtk_radio_button_new_with_mnemonic (NULL, _("Complement"));
  gtk_widget_show (radiobutton_console_readingmethod_reverse);
  gtk_fixed_put (GTK_FIXED (fixed_console_readingmethod), radiobutton_console_readingmethod_reverse, 16, 32);
  gtk_widget_set_size_request (radiobutton_console_readingmethod_reverse, 130, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_reverse), radiobutton_console_readingmethod_original_group);
  radiobutton_console_readingmethod_original_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_reverse));

  radiobutton_console_readingmethod_originalandreverse = gtk_radio_button_new_with_mnemonic (NULL, _("Both"));
  gtk_widget_show (radiobutton_console_readingmethod_originalandreverse);
  gtk_fixed_put (GTK_FIXED (fixed_console_readingmethod), radiobutton_console_readingmethod_originalandreverse, 16, 56);
  gtk_widget_set_size_request (radiobutton_console_readingmethod_originalandreverse, 130, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_originalandreverse), radiobutton_console_readingmethod_original_group);
  radiobutton_console_readingmethod_original_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_console_readingmethod_originalandreverse));

  label_console_readingmethod = gtk_label_new (_("Sequence"));
  gtk_widget_show (label_console_readingmethod);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_readingmethod), label_console_readingmethod);
  gtk_label_set_justify (GTK_LABEL (label_console_readingmethod), GTK_JUSTIFY_LEFT);

  frame_console_ktuples = gtk_frame_new (NULL);
  gtk_widget_show (frame_console_ktuples);
  gtk_fixed_put (GTK_FIXED (fixed_console_settings), frame_console_ktuples, 5, 0);
  gtk_widget_set_size_request (frame_console_ktuples, 138, 55);
  gtk_frame_set_label_align (GTK_FRAME (frame_console_ktuples), 0.5, 0.5);

  fixed_console_ktuples = gtk_fixed_new ();
  gtk_widget_show (fixed_console_ktuples);
  gtk_container_add (GTK_CONTAINER (frame_console_ktuples), fixed_console_ktuples);

  spinbutton_console_ktuples_adj = gtk_adjustment_new (9, 1, 9, 1, 10, 10);
  spinbutton_console_ktuples = gtk_spin_button_new (GTK_ADJUSTMENT (spinbutton_console_ktuples_adj), 1, 0);
  gtk_widget_show (spinbutton_console_ktuples);
  gtk_fixed_put (GTK_FIXED (fixed_console_ktuples), spinbutton_console_ktuples, 50, 8);
  gtk_widget_set_size_request (spinbutton_console_ktuples, 70, 24);
  gtk_spin_button_set_numeric (GTK_SPIN_BUTTON (spinbutton_console_ktuples), TRUE);
  gtk_spin_button_set_update_policy (GTK_SPIN_BUTTON (spinbutton_console_ktuples), GTK_UPDATE_IF_VALID);

  label_console_ktuples_K = gtk_label_new (_("K = "));
  gtk_widget_show (label_console_ktuples_K);
  gtk_fixed_put (GTK_FIXED (fixed_console_ktuples), label_console_ktuples_K, 7, 12);
  gtk_widget_set_size_request (label_console_ktuples_K, 41, 16);
  gtk_label_set_justify (GTK_LABEL (label_console_ktuples_K), GTK_JUSTIFY_LEFT);

  label_console_ktuples = gtk_label_new (_("K Tuples"));
  gtk_widget_show (label_console_ktuples);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_ktuples), label_console_ktuples);
  gtk_label_set_justify (GTK_LABEL (label_console_ktuples), GTK_JUSTIFY_LEFT);

  button_console_advancedsettings = gtk_button_new ();
  gtk_widget_show (button_console_advancedsettings);
  gtk_fixed_put (GTK_FIXED (fixed_console_settings), button_console_advancedsettings, 212, 122);
  gtk_widget_set_size_request (button_console_advancedsettings, 100, 38);

  alignment1 = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment1);
  gtk_container_add (GTK_CONTAINER (button_console_advancedsettings), alignment1);

  hbox4 = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox4);
  gtk_container_add (GTK_CONTAINER (alignment1), hbox4);

  image_console_advancedsettings = gtk_image_new_from_stock ("gtk-preferences", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_console_advancedsettings);
  gtk_box_pack_start (GTK_BOX (hbox4), image_console_advancedsettings, FALSE, FALSE, 0);

  label_console_advancedsettings = gtk_label_new_with_mnemonic (_("Advanced\n Settings"));
  gtk_widget_show (label_console_advancedsettings);
  gtk_box_pack_start (GTK_BOX (hbox4), label_console_advancedsettings, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_console_advancedsettings), GTK_JUSTIFY_LEFT);

  label_console_settings = gtk_label_new (_("Settings"));
  gtk_widget_show (label_console_settings);
  gtk_frame_set_label_widget (GTK_FRAME (frame_console_settings), label_console_settings);
  gtk_label_set_justify (GTK_LABEL (label_console_settings), GTK_JUSTIFY_LEFT);

  statusbar_console = gtk_statusbar_new ();
  gtk_widget_show (statusbar_console);
  gtk_box_pack_start (GTK_BOX (vbox_console), statusbar_console, FALSE, FALSE, 0);



	Console *current_console = (Console*)g_malloc(sizeof(Console));
	current_console->clist = (GtkCList*)clist_console_sequencefile;
	current_console->textview = textview_console_seqinfo;
	

	ConsoleColormode* console_colorlist = (ConsoleColormode*)g_malloc(sizeof(ConsoleColormode));
	console_colorlist->drawing_colormode = drawingarea_console_colormode;
	console_colorlist->colorlist = colorlist;
	console_colorlist->advancedsettings = NULL;
	
  g_signal_connect ((gpointer) open1, "activate",
                    G_CALLBACK (on_open_console_activate),
                    current_console);
  g_signal_connect ((gpointer) close1, "activate",
                    G_CALLBACK (on_close_console_activate),
                    current_console);                  
  g_signal_connect ((gpointer) quit1, "activate",
                    G_CALLBACK (gtk_main_quit),
                    console);
  g_signal_connect ((gpointer) settings1, "activate",
                    G_CALLBACK (on_preferences_console_activate),
                    console_colorlist);
  g_signal_connect ((gpointer) about1, "activate",
                    G_CALLBACK (on_about_console_activate),
                    about);
                
  g_signal_connect ((gpointer) fixed_console, "destroy",
                    G_CALLBACK (gtk_main_quit),
                    NULL);
  g_signal_connect ((gpointer) clist_console_sequencefile, "select_row",
                    G_CALLBACK (on_clist_console_sequencefile_select_row),
                    current_console);
  g_signal_connect ((gpointer) button_console_drawingpanel_histogram, "clicked",
                    G_CALLBACK (on_button_console_drawingpanel_histogram_clicked),
                    histogram);
  g_signal_connect ((gpointer) button_console_drawingpanel_portrait, "clicked",
                    G_CALLBACK (on_button_console_drawingpanel_portrait_clicked),
                    portrait);
  g_signal_connect ((gpointer) drawingarea_console_colormode, "expose_event",
                    G_CALLBACK (on_drawingarea_console_colormode_expose_event),
                    colorlist);
  g_signal_connect ((gpointer) radiobutton_console_randomization_none, "toggled",
                    G_CALLBACK (on_radiobutton_console_randomization_none_toggled),
                    NULL);
  g_signal_connect ((gpointer) radiobutton_console_randomization_applicated, "toggled",
                    G_CALLBACK (on_radiobutton_console_randomization_applicated_toggled),
                    NULL);
  g_signal_connect ((gpointer) radiobutton_console_readingmethod_original, "toggled",
                    G_CALLBACK (on_radiobutton_console_readingmethod_original_toggled),
                    NULL);
  g_signal_connect ((gpointer) radiobutton_console_readingmethod_reverse, "toggled",
                    G_CALLBACK (on_radiobutton_console_readingmethod_reverse_toggled),
                    NULL);
  g_signal_connect ((gpointer) radiobutton_console_readingmethod_originalandreverse, "toggled",
                    G_CALLBACK (on_radiobutton_console_readingmethod_originalandreverse_toggled),
                    NULL);
  g_signal_connect ((gpointer) spinbutton_console_ktuples, "value_changed",
                    G_CALLBACK (on_spinbutton_console_ktuples_value_changed),
                    spinbutton_console_ktuples);
  g_signal_connect ((gpointer) button_console_advancedsettings, "clicked",
                    G_CALLBACK (on_button_console_advancedsettings_clicked),
                    console_colorlist);

  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (console, console, "console");
  GLADE_HOOKUP_OBJECT (console, vbox_console, "vbox_console");
  GLADE_HOOKUP_OBJECT (console, menubar1, "menubar1");
  GLADE_HOOKUP_OBJECT (console, menuitem1, "menuitem1");
  GLADE_HOOKUP_OBJECT (console, menu1, "menu1");
  GLADE_HOOKUP_OBJECT (console, open1, "open1");
  GLADE_HOOKUP_OBJECT (console, close1, "close1");
  GLADE_HOOKUP_OBJECT (console, separatormenuitem1, "separatormenuitem1");
  GLADE_HOOKUP_OBJECT (console, quit1, "quit1");
  GLADE_HOOKUP_OBJECT (console, menuitem2, "menuitem2");
  GLADE_HOOKUP_OBJECT (console, menu2, "menu2");
  GLADE_HOOKUP_OBJECT (console, settings1, "settings1");
  GLADE_HOOKUP_OBJECT (console, menuitem3, "menuitem3");
  GLADE_HOOKUP_OBJECT (console, menu3, "menu3");
  GLADE_HOOKUP_OBJECT (console, about1, "about1");
  GLADE_HOOKUP_OBJECT (console, fixed_console, "fixed_console");
  GLADE_HOOKUP_OBJECT (console, scrolledwindow_console_file, "scrolledwindow_console_file");
  GLADE_HOOKUP_OBJECT (console, clist_console_sequencefile, "clist_console_sequencefile");
  GLADE_HOOKUP_OBJECT (console, label_console_sequencefile_locus, "label_console_sequencefile_locus");
  GLADE_HOOKUP_OBJECT (console, label_console_sequencefile_description, "label_console_sequencefile_description");
  GLADE_HOOKUP_OBJECT (console, label_console_sequencefile_format, "label_console_sequencefile_format");
  GLADE_HOOKUP_OBJECT (console, label_console_sequencefile_filepath, "label_console_sequencefile_filepath");
  GLADE_HOOKUP_OBJECT (console, frame_console_seqinfo, "frame_console_seqinfo");
  GLADE_HOOKUP_OBJECT (console, scrolledwindow_console_seqinfo, "scrolledwindow_console_seqinfo");
  GLADE_HOOKUP_OBJECT (console, textview_console_seqinfo, "textview_console_seqinfo");
  GLADE_HOOKUP_OBJECT (console, label_console_seqinfo, "label_console_seqinfo");
  GLADE_HOOKUP_OBJECT (console, frame_console_drawingpanel, "frame_console_drawingpanel");
  GLADE_HOOKUP_OBJECT (console, fixed_console_drawingpanel, "fixed_console_drawingpanel");
  GLADE_HOOKUP_OBJECT (console, button_console_drawingpanel_histogram, "button_console_drawingpanel_histogram");
  GLADE_HOOKUP_OBJECT (console, button_console_drawingpanel_portrait, "button_console_drawingpanel_portrait");
  GLADE_HOOKUP_OBJECT (console, label_console_drawingpanel, "label_console_drawingpanel");
  GLADE_HOOKUP_OBJECT (console, frame_console_settings, "frame_console_settings");
  GLADE_HOOKUP_OBJECT (console, fixed_console_settings, "fixed_console_settings");
  GLADE_HOOKUP_OBJECT (console, frame_console_colormode, "frame_console_colormode");
  GLADE_HOOKUP_OBJECT (console, drawingarea_console_colormode, "drawingarea_console_colormode");
  GLADE_HOOKUP_OBJECT (console, label_console_colormode, "label_console_colormode");
  GLADE_HOOKUP_OBJECT (console, frame_console_randomiztion, "frame_console_randomiztion");
  GLADE_HOOKUP_OBJECT (console, fixed_console_randomization, "fixed_console_randomization");
  GLADE_HOOKUP_OBJECT (console, radiobutton_console_randomization_none, "radiobutton_console_randomization_none");
  GLADE_HOOKUP_OBJECT (console, radiobutton_console_randomization_applicated, "radiobutton_console_randomization_applicated");
  GLADE_HOOKUP_OBJECT (console, label_console_randomization, "label_console_randomization");
  GLADE_HOOKUP_OBJECT (console, frame_console_readingmethod, "frame_console_readingmethod");
  GLADE_HOOKUP_OBJECT (console, fixed_console_readingmethod, "fixed_console_readingmethod");
  GLADE_HOOKUP_OBJECT (console, radiobutton_console_readingmethod_original, "radiobutton_console_readingmethod_original");
  GLADE_HOOKUP_OBJECT (console, radiobutton_console_readingmethod_reverse, "radiobutton_console_readingmethod_reverse");
  GLADE_HOOKUP_OBJECT (console, radiobutton_console_readingmethod_originalandreverse, "radiobutton_console_readingmethod_originalandreverse");
  GLADE_HOOKUP_OBJECT (console, label_console_readingmethod, "label_console_readingmethod");
  GLADE_HOOKUP_OBJECT (console, frame_console_ktuples, "frame_console_ktuples");
  GLADE_HOOKUP_OBJECT (console, fixed_console_ktuples, "fixed_console_ktuples");
  GLADE_HOOKUP_OBJECT (console, spinbutton_console_ktuples, "spinbutton_console_ktuples");
  GLADE_HOOKUP_OBJECT (console, label_console_ktuples_K, "label_console_ktuples_K");
  GLADE_HOOKUP_OBJECT (console, label_console_ktuples, "label_console_ktuples");
  GLADE_HOOKUP_OBJECT (console, button_console_advancedsettings, "button_console_advancedsettings");
  GLADE_HOOKUP_OBJECT (console, alignment1, "alignment1");
  GLADE_HOOKUP_OBJECT (console, hbox4, "hbox4");
  GLADE_HOOKUP_OBJECT (console, image_console_advancedsettings, "image_console_advancedsettings");
  GLADE_HOOKUP_OBJECT (console, label_console_advancedsettings, "label_console_advancedsettings");
  GLADE_HOOKUP_OBJECT (console, label_console_settings, "label_console_settings");
  GLADE_HOOKUP_OBJECT (console, statusbar_console, "statusbar_console");

  return console;
}

GtkWidget*
create_portrait (Portrait *current_portrait)
{
  GtkWidget *portrait;
  GtkWidget *comparation;
  GtkWidget *fixed_portrait;
  GtkWidget *textview_portrait_pointcontext;
  GtkWidget *frame_portrait_drawing;
  GtkWidget *drawingarea_portrait_drawing;
  GtkWidget *frame_portrait_colormode;
  GtkWidget *fixed_portrait_colormode;
  GtkWidget *drawingarea_portrait_colormode;
  GtkWidget *label_portrait_colormode_range;
  GtkWidget *frame_portrait_control;
  GtkWidget *fixed_portrait_control;

  GtkWidget *button_portrait_compare;
  GtkWidget *alignment_portrait_compare;
  GtkWidget *hbox_portrait_compare;
  GtkWidget *image_portrait_compare;
  GtkWidget *label_portrait_compare;
  GtkWidget *button_portrait_export;
  GtkWidget *alignment_portrait_export;
  GtkWidget *hbox_portrait_export;
  GtkWidget *image_portrait_export;
  GtkWidget *label_portrait_export;

  portrait = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_window_set_title (GTK_WINDOW (portrait),current_portrait->ID);
  gtk_window_set_position (GTK_WINDOW (portrait), GTK_WIN_POS_CENTER);
  gtk_window_set_default_size (GTK_WINDOW (portrait), 522, 686);//706
  gtk_window_set_resizable (GTK_WINDOW (portrait), FALSE);

  fixed_portrait = gtk_fixed_new ();
  gtk_widget_show (fixed_portrait);
  gtk_container_add (GTK_CONTAINER (portrait), fixed_portrait);
  gtk_widget_set_size_request (fixed_portrait, 522, 590);

  textview_portrait_pointcontext = gtk_text_view_new ();
  gtk_widget_show (textview_portrait_pointcontext);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), textview_portrait_pointcontext, 8, 558);
  gtk_widget_set_size_request (textview_portrait_pointcontext, 281, 20);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_portrait_pointcontext), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_portrait_pointcontext), FALSE);
  gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (textview_portrait_pointcontext)),
	_("The context of the current mouse point."), -1);

  frame_portrait_drawing = gtk_frame_new (NULL);
  gtk_widget_show (frame_portrait_drawing);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), frame_portrait_drawing, 0, 0);
  gtk_widget_set_size_request (frame_portrait_drawing, 522, 522);
  gtk_container_set_border_width (GTK_CONTAINER (frame_portrait_drawing), 3);

  drawingarea_portrait_drawing = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_portrait_drawing);
  gtk_container_add (GTK_CONTAINER (frame_portrait_drawing), drawingarea_portrait_drawing);
  gtk_widget_set_size_request (drawingarea_portrait_drawing, 512, 512);
  gtk_widget_set_events (drawingarea_portrait_drawing,  GDK_POINTER_MOTION_MASK);

  frame_portrait_colormode = gtk_frame_new (NULL);
  gtk_widget_show (frame_portrait_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), frame_portrait_colormode, 0, 519);
  gtk_widget_set_size_request (frame_portrait_colormode, 522, 34);
  gtk_container_set_border_width (GTK_CONTAINER (frame_portrait_colormode), 3);

  fixed_portrait_colormode = gtk_fixed_new ();
  gtk_widget_show (fixed_portrait_colormode);
  gtk_container_add (GTK_CONTAINER (frame_portrait_colormode), fixed_portrait_colormode);

  drawingarea_portrait_colormode = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_portrait_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_portrait_colormode), drawingarea_portrait_colormode, 0, 0);
  gtk_widget_set_size_request (drawingarea_portrait_colormode, 512, 10);

	char 	range[120];
	char 	temp_string[3][50];
	int		str_len[3];
	int		str_number[3] ={1,8,15};
	int		num,count;
	int		interval;
	for(num=0;num<3;num++){
		sprintf(temp_string[num],"%d",current_portrait->area_mark[str_number[num]]);
		str_len[num]=strlen(temp_string[num]);
	}
	for(num=0;num<119;num++)
		range[num] = ' ';
	range[num] = '\0';
	interval = (114-str_len[2])/2 - str_len[2]/2;
	for(num=0;num<3;num++){
		for(count=0;count<str_len[num];count++){
			range[num*interval+count+2] = temp_string[num][count];
		}
	}

  label_portrait_colormode_range = gtk_label_new (range);
  gtk_widget_show (label_portrait_colormode_range);
  gtk_fixed_put (GTK_FIXED (fixed_portrait_colormode), label_portrait_colormode_range, 0, 10);
  gtk_widget_set_size_request (label_portrait_colormode_range, 512, 16);
  gtk_label_set_justify (GTK_LABEL (label_portrait_colormode_range), GTK_JUSTIFY_LEFT);

  frame_portrait_control = gtk_frame_new (NULL);
  gtk_widget_show (frame_portrait_control);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), frame_portrait_control, 0, 550);
  gtk_widget_set_size_request (frame_portrait_control, 522, 40);
  gtk_container_set_border_width (GTK_CONTAINER (frame_portrait_control), 3);

  fixed_portrait_control = gtk_fixed_new ();
  gtk_widget_show (fixed_portrait_control);
  gtk_container_add (GTK_CONTAINER (frame_portrait_control), fixed_portrait_control);

  button_portrait_compare = gtk_button_new ();
  gtk_widget_show (button_portrait_compare);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), button_portrait_compare, 294, 556);
  gtk_widget_set_size_request (button_portrait_compare, 110, 26);

  alignment_portrait_compare = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_portrait_compare);
  gtk_container_add (GTK_CONTAINER (button_portrait_compare), alignment_portrait_compare);

  hbox_portrait_compare = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_portrait_compare);
  gtk_container_add (GTK_CONTAINER (alignment_portrait_compare), hbox_portrait_compare);

  image_portrait_compare = gtk_image_new_from_stock ("gtk-execute", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_portrait_compare);
  gtk_box_pack_start (GTK_BOX (hbox_portrait_compare), image_portrait_compare, FALSE, FALSE, 0);

  label_portrait_compare = gtk_label_new_with_mnemonic (_("COMPARE"));
  gtk_widget_show (label_portrait_compare);
  gtk_box_pack_start (GTK_BOX (hbox_portrait_compare), label_portrait_compare, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_portrait_compare), GTK_JUSTIFY_LEFT);

  button_portrait_export = gtk_button_new ();
  gtk_widget_show (button_portrait_export);
  gtk_fixed_put (GTK_FIXED (fixed_portrait), button_portrait_export, 406, 556);
  gtk_widget_set_size_request (button_portrait_export, 110, 26);

  alignment_portrait_export = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_portrait_export);
  gtk_container_add (GTK_CONTAINER (button_portrait_export), alignment_portrait_export);

  hbox_portrait_export = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_portrait_export);
  gtk_container_add (GTK_CONTAINER (alignment_portrait_export), hbox_portrait_export);

  image_portrait_export = gtk_image_new_from_stock ("gtk-go-forward", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_portrait_export);
  gtk_box_pack_start (GTK_BOX (hbox_portrait_export), image_portrait_export, FALSE, FALSE, 0);

  label_portrait_export = gtk_label_new_with_mnemonic (_("EXPORT"));
  gtk_widget_show (label_portrait_export);
  gtk_box_pack_start (GTK_BOX (hbox_portrait_export), label_portrait_export, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_portrait_export), GTK_JUSTIFY_LEFT);

  MousePress *current_mouse = 	malloc(sizeof(MousePress)); 
  current_mouse->textview 	= 	textview_portrait_pointcontext;
  current_mouse->portrait	=	current_portrait;

  int n,i;	
  GdkColor	gdkcolor;
  gdkcolor.red		=	1.0*0xffff; 
  gdkcolor.green	=	0.5*0xffff; 
  gdkcolor.blue		=	0.5*0xffff;	
  
  GtkStyle *style;
  style = gtk_style_copy(gtk_widget_get_style(drawingarea_portrait_drawing));
  for( i = 0;i<5;i++)
     style->fg[i] = gdkcolor;
  gtk_widget_set_style(drawingarea_portrait_drawing,style); 

  g_signal_connect ((gpointer) drawingarea_portrait_drawing, "expose_event",
                    G_CALLBACK (on_drawingarea_portrait_expose_event),
                    current_portrait->portrait_draw);
  g_signal_connect ((gpointer) drawingarea_portrait_colormode, "expose_event",
                    G_CALLBACK (on_drawingarea_portrait_colormode_expose_event),
                    current_portrait->portrait_colorlist);
  g_signal_connect ((gpointer) button_portrait_compare, "clicked",
                    G_CALLBACK (on_button_portrait_compare_clicked),
                    current_portrait);
  g_signal_connect ((gpointer) button_portrait_export, "clicked",
                    G_CALLBACK (on_button_portrait_export_clicked),
                    current_portrait);
  g_signal_connect ((gpointer) portrait,"destroy",
					G_CALLBACK(on_portrait_destroy),
					current_portrait);
  g_signal_connect ((gpointer) drawingarea_portrait_drawing, "motion_notify_event",
                    G_CALLBACK (on_drawingarea_portrait_drawing_motion_notify_event),
                    current_mouse);
  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (portrait, portrait, "portrait");
  GLADE_HOOKUP_OBJECT (portrait, fixed_portrait, "fixed_portrait");
  GLADE_HOOKUP_OBJECT (portrait, textview_portrait_pointcontext, "textview_portrait_pointcontext");
  GLADE_HOOKUP_OBJECT (portrait, frame_portrait_drawing, "frame_portrait_drawing");
  GLADE_HOOKUP_OBJECT (portrait, drawingarea_portrait_drawing, "drawingarea_portrait_drawing");
  GLADE_HOOKUP_OBJECT (portrait, frame_portrait_colormode, "frame_portrait_colormode");
  GLADE_HOOKUP_OBJECT (portrait, fixed_portrait_colormode, "fixed_portrait_colormode");
  GLADE_HOOKUP_OBJECT (portrait, drawingarea_portrait_colormode, "drawingarea_portrait_colormode");
  GLADE_HOOKUP_OBJECT (portrait, label_portrait_colormode_range, "label_portrait_colormode_range");
  GLADE_HOOKUP_OBJECT (portrait, frame_portrait_control, "frame_portrait_control");
  GLADE_HOOKUP_OBJECT (portrait, fixed_portrait_control, "fixed_portrait_control");
  GLADE_HOOKUP_OBJECT (portrait, button_portrait_compare, "button_portrait_compare");
  GLADE_HOOKUP_OBJECT (portrait, alignment_portrait_compare, "alignment_portrait_compare");
  GLADE_HOOKUP_OBJECT (portrait, hbox_portrait_compare, "hbox_portrait_compare");
  GLADE_HOOKUP_OBJECT (portrait, image_portrait_compare, "image_portrait_compare");
  GLADE_HOOKUP_OBJECT (portrait, label_portrait_compare, "label_portrait_compare");
  GLADE_HOOKUP_OBJECT (portrait, button_portrait_export, "button_portrait_export");
  GLADE_HOOKUP_OBJECT (portrait, alignment_portrait_export, "alignment_portrait_export");
  GLADE_HOOKUP_OBJECT (portrait, hbox_portrait_export, "hbox_portrait_export");
  GLADE_HOOKUP_OBJECT (portrait, image_portrait_export, "image_portrait_export");
  GLADE_HOOKUP_OBJECT (portrait, label_portrait_export, "label_portrait_export");

  return portrait;
}

GtkWidget*
create_histogram (Portrait* current_histogram)
{
  GtkWidget *histogram;
  GtkWidget *fixed_histogram;
  GtkWidget *textview_histogram_context;
  GtkWidget *frame_histogram_drawing;
  GtkWidget *drawingarea_histogram_drawing;
  GtkWidget *label_histogram_notice;
  GtkWidget *frame_histogram_control;
  GtkWidget *fixed_histogram_control;
  GtkWidget *button_histogram_export;
  GtkWidget *alignment_histogram_export;
  GtkWidget *hbox_histogram_export;
  GtkWidget *image_histogram_export;
  GtkWidget *label_histogram_export;

  histogram = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_window_set_title (GTK_WINDOW (histogram), current_histogram->ID);
  gtk_window_set_position (GTK_WINDOW (histogram), GTK_WIN_POS_CENTER);
  gtk_window_set_default_size (GTK_WINDOW (histogram), 522, 700);
  gtk_window_set_resizable (GTK_WINDOW (histogram), FALSE);

  fixed_histogram = gtk_fixed_new ();
  gtk_widget_show (fixed_histogram);
  gtk_container_add (GTK_CONTAINER (histogram), fixed_histogram);
  gtk_widget_set_size_request (fixed_histogram, 522, 580);

  textview_histogram_context = gtk_text_view_new ();
  gtk_widget_show (textview_histogram_context);
  gtk_fixed_put (GTK_FIXED (fixed_histogram), textview_histogram_context, 8, 548);
  gtk_widget_set_size_request (textview_histogram_context, 340, 20);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_histogram_context), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_histogram_context), FALSE);
  gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (textview_histogram_context)),
	_("The context of the point."), -1);

  frame_histogram_drawing = gtk_frame_new (NULL);
  gtk_widget_show (frame_histogram_drawing);
  gtk_fixed_put (GTK_FIXED (fixed_histogram), frame_histogram_drawing, 0, 0);
  gtk_widget_set_size_request (frame_histogram_drawing, 522, 522);
  gtk_container_set_border_width (GTK_CONTAINER (frame_histogram_drawing), 3);

  drawingarea_histogram_drawing = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_histogram_drawing);
  gtk_container_add (GTK_CONTAINER (frame_histogram_drawing), drawingarea_histogram_drawing);
  gtk_widget_set_size_request (drawingarea_histogram_drawing, 512, 512);
  gtk_widget_set_events (drawingarea_histogram_drawing, GDK_BUTTON_PRESS_MASK);

  label_histogram_notice = gtk_label_new (_("Press Mouse Left Button to show the count value of current point."));
  gtk_widget_show (label_histogram_notice);
  gtk_fixed_put (GTK_FIXED (fixed_histogram), label_histogram_notice, 8, 528);
  gtk_widget_set_size_request (label_histogram_notice, 390, 20);
  gtk_label_set_justify (GTK_LABEL (label_histogram_notice), GTK_JUSTIFY_LEFT);

  frame_histogram_control = gtk_frame_new (NULL);
  gtk_widget_show (frame_histogram_control);
  gtk_fixed_put (GTK_FIXED (fixed_histogram), frame_histogram_control, 0, 520);
  gtk_widget_set_size_request (frame_histogram_control, 522, 60);
  gtk_container_set_border_width (GTK_CONTAINER (frame_histogram_control), 3);

  fixed_histogram_control = gtk_fixed_new ();
  gtk_widget_show (fixed_histogram_control);
  gtk_container_add (GTK_CONTAINER (frame_histogram_control), fixed_histogram_control);

  button_histogram_export = gtk_button_new ();
  gtk_widget_show (button_histogram_export);
  gtk_fixed_put (GTK_FIXED (fixed_histogram), button_histogram_export, 400, 544);
  gtk_widget_set_size_request (button_histogram_export, 110, 26);

  alignment_histogram_export = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_histogram_export);
  gtk_container_add (GTK_CONTAINER (button_histogram_export), alignment_histogram_export);

  hbox_histogram_export = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_histogram_export);
  gtk_container_add (GTK_CONTAINER (alignment_histogram_export), hbox_histogram_export);

  image_histogram_export = gtk_image_new_from_stock ("gtk-go-forward", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_histogram_export);
  gtk_box_pack_start (GTK_BOX (hbox_histogram_export), image_histogram_export, FALSE, FALSE, 0);

  label_histogram_export = gtk_label_new_with_mnemonic (_("EXPORT"));
  gtk_widget_show (label_histogram_export);
  gtk_box_pack_start (GTK_BOX (hbox_histogram_export), label_histogram_export, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_histogram_export), GTK_JUSTIFY_LEFT);

  MousePress *current_data = 	g_malloc(sizeof(MousePress)); 
  current_data->textview 	= 	textview_histogram_context;
  current_data->portrait	=	current_histogram;
  current_data->MousePressed = FALSE;
  current_data->MousePosition[0] = -1;
  current_data->MousePosition[1] = -1;
  
  int n,i;	
  GdkColor	gdkcolor;
  gdkcolor.red		=	1.0*0xffff; 
  gdkcolor.green	=	0.5*0xffff; 
  gdkcolor.blue		=	1.0*0xffff;	
  
  GtkStyle *style;
  style = gtk_style_copy(gtk_widget_get_style(drawingarea_histogram_drawing));
  for( i = 0;i<5;i++)
     style->fg[i] = gdkcolor;
  gtk_widget_set_style(drawingarea_histogram_drawing,style); 
  
  g_signal_connect ((gpointer) drawingarea_histogram_drawing, "expose_event",
                    G_CALLBACK (on_drawingarea_histogram_expose_event),
                    current_data);
  g_signal_connect ((gpointer) drawingarea_histogram_drawing, "button_press_event",
                    G_CALLBACK (on_drawingarea_histogram_button_press_event),
                    current_data);
  g_signal_connect ((gpointer) button_histogram_export, "clicked",
                    G_CALLBACK (on_button_histogram_export_clicked),
                    current_histogram);
  g_signal_connect ((gpointer) histogram,"destroy",
					G_CALLBACK(on_portrait_destroy),
					current_histogram);
  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (histogram, histogram, "histogram");
  GLADE_HOOKUP_OBJECT (histogram, fixed_histogram, "fixed_histogram");
  GLADE_HOOKUP_OBJECT (histogram, textview_histogram_context, "textview_histogram_context");
  GLADE_HOOKUP_OBJECT (histogram, frame_histogram_drawing, "frame_histogram_drawing");
  GLADE_HOOKUP_OBJECT (histogram, drawingarea_histogram_drawing, "drawingarea_histogram_drawing");
  GLADE_HOOKUP_OBJECT (histogram, label_histogram_notice, "label_histogram_notice");
  GLADE_HOOKUP_OBJECT (histogram, frame_histogram_control, "frame_histogram_control");
  GLADE_HOOKUP_OBJECT (histogram, fixed_histogram_control, "fixed_histogram_control");
  GLADE_HOOKUP_OBJECT (histogram, button_histogram_export, "button_histogram_export");
  GLADE_HOOKUP_OBJECT (histogram, alignment_histogram_export, "alignment_histogram_export");
  GLADE_HOOKUP_OBJECT (histogram, hbox_histogram_export, "hbox_histogram_export");
  GLADE_HOOKUP_OBJECT (histogram, image_histogram_export, "image_histogram_export");
  GLADE_HOOKUP_OBJECT (histogram, label_histogram_export, "label_histogram_export");

  return histogram;
}

GtkWidget*
create_compresult (Portrait *output)
{
  GtkWidget *compresult;
  GtkWidget *fixed_compresult;
  GtkWidget *frame_compresult_drawing;
  GtkWidget *drawingarea_compresult_drawing;
  GtkWidget *frame_compresult_colormode;
  GtkWidget *fixed_compresult_colormode;
  GtkWidget *drawingarea_compresult_colormode;
  GtkWidget *label_compresult_colormode_range;
  GtkWidget *frame_compresult_control;
  GtkWidget *fixed_compresult_control;
  GtkWidget *textview_compresult_control_information;
  GtkWidget *button_compresult_export;
  GtkWidget *alignment_compresult_export;
  GtkWidget *hbox_compresult_export;
  GtkWidget *image_compresult_export;
  GtkWidget *label_compresult_export;

  compresult = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_window_set_title (GTK_WINDOW (compresult),output->ID);
  gtk_window_set_position (GTK_WINDOW (compresult), GTK_WIN_POS_CENTER);
  gtk_window_set_default_size (GTK_WINDOW (compresult), 522, 700);
  gtk_window_set_resizable (GTK_WINDOW (compresult), FALSE);

  fixed_compresult = gtk_fixed_new ();
  gtk_widget_show (fixed_compresult);
  gtk_container_add (GTK_CONTAINER (compresult), fixed_compresult);
  gtk_widget_set_size_request (fixed_compresult, 522, 592);

  frame_compresult_drawing = gtk_frame_new (NULL);
  gtk_widget_show (frame_compresult_drawing);
  gtk_fixed_put (GTK_FIXED (fixed_compresult), frame_compresult_drawing, 0, 0);
  gtk_widget_set_size_request (frame_compresult_drawing, 522, 522);
  gtk_container_set_border_width (GTK_CONTAINER (frame_compresult_drawing), 3);

  drawingarea_compresult_drawing = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_compresult_drawing);
  gtk_container_add (GTK_CONTAINER (frame_compresult_drawing), drawingarea_compresult_drawing);
  gtk_widget_set_size_request (drawingarea_compresult_drawing, 512, 512);
  gtk_widget_set_events (drawingarea_compresult_drawing, GDK_POINTER_MOTION_MASK);

  frame_compresult_colormode = gtk_frame_new (NULL);
  gtk_widget_show (frame_compresult_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_compresult), frame_compresult_colormode, 0, 519);
  gtk_widget_set_size_request (frame_compresult_colormode, 522, 34);
  gtk_container_set_border_width (GTK_CONTAINER (frame_compresult_colormode), 3);

  fixed_compresult_colormode = gtk_fixed_new ();
  gtk_widget_show (fixed_compresult_colormode);
  gtk_container_add (GTK_CONTAINER (frame_compresult_colormode), fixed_compresult_colormode);

  drawingarea_compresult_colormode = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_compresult_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_compresult_colormode), drawingarea_compresult_colormode, 0, 0);
  gtk_widget_set_size_request (drawingarea_compresult_colormode, 512, 10);

  label_compresult_colormode_range = gtk_label_new (_("-1.0       -0.5          -0.1         -0.01          0.0        +0.01         +0.1        +0.5         +1.0"));
  gtk_widget_show (label_compresult_colormode_range);
  gtk_fixed_put (GTK_FIXED (fixed_compresult_colormode), label_compresult_colormode_range, 0, 10);
  gtk_widget_set_size_request (label_compresult_colormode_range, 512, 16);
  gtk_label_set_justify (GTK_LABEL (label_compresult_colormode_range), GTK_JUSTIFY_LEFT);

  frame_compresult_control = gtk_frame_new (NULL);
  gtk_widget_show (frame_compresult_control);
  gtk_fixed_put (GTK_FIXED (fixed_compresult), frame_compresult_control, 0, 550);
  gtk_widget_set_size_request (frame_compresult_control, 522, 42);
  gtk_container_set_border_width (GTK_CONTAINER (frame_compresult_control), 3);

  fixed_compresult_control = gtk_fixed_new ();
  gtk_widget_show (fixed_compresult_control);
  gtk_container_add (GTK_CONTAINER (frame_compresult_control), fixed_compresult_control);

  textview_compresult_control_information = gtk_text_view_new ();
  gtk_widget_show (textview_compresult_control_information);
  gtk_fixed_put (GTK_FIXED (fixed_compresult_control), textview_compresult_control_information, 4, 4);
  gtk_widget_set_size_request (textview_compresult_control_information, 360, 24);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_compresult_control_information), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_compresult_control_information), FALSE);
  gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (textview_compresult_control_information)),
	_("The Context about the comparation result."), -1);

  button_compresult_export = gtk_button_new ();
  gtk_widget_show (button_compresult_export);
  gtk_fixed_put (GTK_FIXED (fixed_compresult), button_compresult_export, 400, 558);
  gtk_widget_set_size_request (button_compresult_export, 110, 26);

  alignment_compresult_export = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_compresult_export);
  gtk_container_add (GTK_CONTAINER (button_compresult_export), alignment_compresult_export);

  hbox_compresult_export = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_compresult_export);
  gtk_container_add (GTK_CONTAINER (alignment_compresult_export), hbox_compresult_export);

  image_compresult_export = gtk_image_new_from_stock ("gtk-go-forward", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_compresult_export);
  gtk_box_pack_start (GTK_BOX (hbox_compresult_export), image_compresult_export, FALSE, FALSE, 0);

  label_compresult_export = gtk_label_new_with_mnemonic (_("EXPORT"));
  gtk_widget_show (label_compresult_export);
  gtk_box_pack_start (GTK_BOX (hbox_compresult_export), label_compresult_export, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_compresult_export), GTK_JUSTIFY_LEFT);

  MousePress *current_mouse = 	malloc(sizeof(MousePress)); 
  current_mouse->textview 	= 	textview_compresult_control_information;
  current_mouse->portrait	=	output;

  g_signal_connect ((gpointer) drawingarea_compresult_drawing, "expose_event",
                    G_CALLBACK (on_drawingarea_compresult_drawing_expose_event),
                    output->portrait_draw);
  g_signal_connect ((gpointer) drawingarea_compresult_colormode, "expose_event",
                    G_CALLBACK (on_drawingarea_compresult_colormode_expose_event),
                    output->portrait_colorlist);
  g_signal_connect ((gpointer) button_compresult_export, "clicked",
                    G_CALLBACK (on_button_compresult_export_clicked),
                    output);
  g_signal_connect ((gpointer) compresult,"destroy",
					G_CALLBACK(on_portrait_destroy),
					output);
  g_signal_connect ((gpointer) drawingarea_compresult_drawing, "motion_notify_event",
                    G_CALLBACK (on_drawingarea_compresult_drawing_motion_notify_event),
                    current_mouse);					
  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (compresult, compresult, "compresult");
  GLADE_HOOKUP_OBJECT (compresult, fixed_compresult, "fixed_compresult");
  GLADE_HOOKUP_OBJECT (compresult, frame_compresult_drawing, "frame_compresult_drawing");
  GLADE_HOOKUP_OBJECT (compresult, drawingarea_compresult_drawing, "drawingarea_compresult_drawing");
  GLADE_HOOKUP_OBJECT (compresult, frame_compresult_colormode, "frame_compresult_colormode");
  GLADE_HOOKUP_OBJECT (compresult, fixed_compresult_colormode, "fixed_compresult_colormode");
  GLADE_HOOKUP_OBJECT (compresult, drawingarea_compresult_colormode, "drawingarea_compresult_colormode");
  GLADE_HOOKUP_OBJECT (compresult, label_compresult_colormode_range, "label_compresult_colormode_range");
  GLADE_HOOKUP_OBJECT (compresult, frame_compresult_control, "frame_compresult_control");
  GLADE_HOOKUP_OBJECT (compresult, fixed_compresult_control, "fixed_compresult_control");
  GLADE_HOOKUP_OBJECT (compresult, textview_compresult_control_information, "textview_compresult_control_information");
  GLADE_HOOKUP_OBJECT (compresult, button_compresult_export, "button_compresult_export");
  GLADE_HOOKUP_OBJECT (compresult, alignment_compresult_export, "alignment_compresult_export");
  GLADE_HOOKUP_OBJECT (compresult, hbox_compresult_export, "hbox_compresult_export");
  GLADE_HOOKUP_OBJECT (compresult, image_compresult_export, "image_compresult_export");
  GLADE_HOOKUP_OBJECT (compresult, label_compresult_export, "label_compresult_export");

  return compresult;
}

GtkWidget*
create_advancedsettings (ConsoleColormode *color_mode)
{
  GtkWidget *advancedsettings;
  GtkWidget *fixed_advancedsettings;
  GtkWidget *notebook_advancedsettings;
  GtkWidget *fixed_advancedsettings_random;
  GtkWidget *frame_advancedsettings_random_times;
  GtkWidget *fixed_advancedsettings_random_times;
  GtkWidget *combo_advancedsettings_random_times;
  GList *combo_advancedsettings_random_times_items = NULL;
  GtkWidget *entry_advancedsettings_random_times;
  GtkWidget *label_advancedsettings_random_multiseqlen;
  GtkWidget *label_advancedsettings_randomization;
  GtkWidget *label_advancedsettings_random_introduction;
  GtkWidget *fixed_advancedsettings_colormode;
  GtkWidget *frame_advancedsettings_colormode;
  GtkWidget *fixed_advancedsettings_colormode_select;
  GtkWidget *drawingarea_advancedsettings_colormode_high;
  GtkWidget *drawingarea_advancedsettings_colormode_auto;
  GtkWidget *radiobutton_advancedsettings_colormode_highcontrast;
  GSList *radiobutton_advancedsettings_colormode_highcontrast_group = NULL;
  GtkWidget *radiobutton_advancedsettings_colormode_autobalanced;
  GtkWidget *label_advancedsettings_colormode;
  GtkWidget *fixed_advancedsettings_comparation;
  GtkWidget *frame_advancedsettings_cmp_reduction;
  GtkWidget *fixed_advancedsettings_cmp_reduction;
  GtkWidget *textview_advancedsettings_cmp_reduction;
  GtkWidget *radio_advancedsettings_cmp_reduction_yes;
  GSList *radio_advancedsettings_cmp_reduction_yes_group = NULL;
  GtkWidget *radio_advancedsettings_cmp_reduction_no;
  GtkWidget *text_advancedsettings_cmp_reduction_message;
  GtkWidget *frame_advancedsettings_cmp_display;
  GtkWidget *fixed_advancedsettings_cmp_display;
  GtkWidget *combo_advancedsettings_cmp_DAN;
  GList *combo_advancedsettings_cmp_DAN_items = NULL;
  GtkWidget *combo_entry_advancedsettings_cmp_DAN;
  GtkWidget *label_advancedsettings_cmp_DARange;
  GtkWidget *label_advancedsettings_cmp_DAN;
  GtkWidget *text_advancedsettings_cmp_display;
  GtkWidget *text_advancedsettings_comparation;
  GtkWidget *button_advancedsettings_OK;
  GtkWidget *button_advancedsettings_CANCEL;
  GtkWidget *button_advancedsettings_APPLY;

  advancedsettings = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_widget_set_size_request (advancedsettings, 400, 290);
  gtk_window_set_position (GTK_WINDOW (advancedsettings), GTK_WIN_POS_CENTER);
  gtk_window_set_modal (GTK_WINDOW (advancedsettings), TRUE);
  gtk_window_set_title (GTK_WINDOW (advancedsettings), _("Advanced Settings"));
  gtk_window_set_resizable (GTK_WINDOW (advancedsettings), FALSE);

  fixed_advancedsettings = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings);
  gtk_container_add (GTK_CONTAINER (advancedsettings), fixed_advancedsettings);

  notebook_advancedsettings = gtk_notebook_new ();
  gtk_widget_show (notebook_advancedsettings);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings), notebook_advancedsettings, 4, 4);
  gtk_widget_set_size_request (notebook_advancedsettings, 392, 250);

  fixed_advancedsettings_random = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_random);
  gtk_container_add (GTK_CONTAINER (notebook_advancedsettings), fixed_advancedsettings_random);

  frame_advancedsettings_random_times = gtk_frame_new (NULL);
  gtk_widget_show (frame_advancedsettings_random_times);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_random), frame_advancedsettings_random_times, 8, 8);
  gtk_widget_set_size_request (frame_advancedsettings_random_times, 368, 126);
  gtk_frame_set_label_align (GTK_FRAME (frame_advancedsettings_random_times), 0.5, 0.5);

  fixed_advancedsettings_random_times = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_random_times);
  gtk_container_add (GTK_CONTAINER (frame_advancedsettings_random_times), fixed_advancedsettings_random_times);

  label_advancedsettings_random_introduction = gtk_label_new (_(" Randomization is carried out with respect to the whole \nDNA sequence. You may choose how many times (X) \nit is applied to the sequence."));
  gtk_widget_show (label_advancedsettings_random_introduction);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_random_times), label_advancedsettings_random_introduction, 4, 4);
  gtk_widget_set_size_request (label_advancedsettings_random_introduction, 356, 60);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_random_introduction), GTK_JUSTIFY_LEFT);

  combo_advancedsettings_random_times = gtk_combo_new ();
  g_object_set_data (G_OBJECT (GTK_COMBO (combo_advancedsettings_random_times)->popwin),
                     "GladeParentKey", combo_advancedsettings_random_times);
  gtk_widget_show (combo_advancedsettings_random_times);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_random_times), combo_advancedsettings_random_times, 248, 54);
  gtk_widget_set_size_request (combo_advancedsettings_random_times, 60, 18);
  gtk_combo_set_use_arrows (GTK_COMBO (combo_advancedsettings_random_times), FALSE);
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("1"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("2"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("4"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("8"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("10"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("20"));
  combo_advancedsettings_random_times_items = g_list_append (combo_advancedsettings_random_times_items, (gpointer) _("40"));
  gtk_combo_set_popdown_strings (GTK_COMBO (combo_advancedsettings_random_times), combo_advancedsettings_random_times_items);
  g_list_free (combo_advancedsettings_random_times_items);

  entry_advancedsettings_random_times = GTK_COMBO (combo_advancedsettings_random_times)->entry;
  gtk_widget_show (entry_advancedsettings_random_times);
  gtk_widget_set_size_request (entry_advancedsettings_random_times, 158, 18);
  gtk_editable_set_editable (GTK_EDITABLE (entry_advancedsettings_random_times), FALSE);

  label_advancedsettings_random_multiseqlen = gtk_label_new (_("X"));
  gtk_widget_show (label_advancedsettings_random_multiseqlen);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_random_times), label_advancedsettings_random_multiseqlen, 308, 54);
  gtk_widget_set_size_request (label_advancedsettings_random_multiseqlen, 20, 18);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_random_multiseqlen), GTK_JUSTIFY_LEFT);

  label_advancedsettings_randomization = gtk_label_new (_("Randomization"));
  gtk_widget_show (label_advancedsettings_randomization);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook_advancedsettings), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook_advancedsettings), 0), label_advancedsettings_randomization);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_randomization), GTK_JUSTIFY_LEFT);

  fixed_advancedsettings_colormode = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_colormode);
  gtk_container_add (GTK_CONTAINER (notebook_advancedsettings), fixed_advancedsettings_colormode);

  frame_advancedsettings_colormode = gtk_frame_new (NULL);
  gtk_widget_show (frame_advancedsettings_colormode);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_colormode), frame_advancedsettings_colormode, 8, 8);
  gtk_widget_set_size_request (frame_advancedsettings_colormode, 368, 208);
  gtk_frame_set_label_align (GTK_FRAME (frame_advancedsettings_colormode), 0.5, 0.5);

  fixed_advancedsettings_colormode_select = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_colormode_select);
  gtk_container_add (GTK_CONTAINER (frame_advancedsettings_colormode), fixed_advancedsettings_colormode_select);

  drawingarea_advancedsettings_colormode_high = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_advancedsettings_colormode_high);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_colormode_select), drawingarea_advancedsettings_colormode_high, 32, 32);
  gtk_widget_set_size_request (drawingarea_advancedsettings_colormode_high, 320, 20);

  drawingarea_advancedsettings_colormode_auto = gtk_drawing_area_new ();
  gtk_widget_show (drawingarea_advancedsettings_colormode_auto);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_colormode_select), drawingarea_advancedsettings_colormode_auto, 32, 96);
  gtk_widget_set_size_request (drawingarea_advancedsettings_colormode_auto, 320, 20);

  radiobutton_advancedsettings_colormode_highcontrast = gtk_radio_button_new_with_mnemonic (NULL, _("Higelight Small Counts"));
  gtk_widget_show (radiobutton_advancedsettings_colormode_highcontrast);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_colormode_select), radiobutton_advancedsettings_colormode_highcontrast, 8, 8);
  gtk_widget_set_size_request (radiobutton_advancedsettings_colormode_highcontrast, 220, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_advancedsettings_colormode_highcontrast), radiobutton_advancedsettings_colormode_highcontrast_group);
  radiobutton_advancedsettings_colormode_highcontrast_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_advancedsettings_colormode_highcontrast));

  radiobutton_advancedsettings_colormode_autobalanced = gtk_radio_button_new_with_mnemonic (NULL, _("Auto-Balanced Color Range"));
  gtk_widget_show (radiobutton_advancedsettings_colormode_autobalanced);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_colormode_select), radiobutton_advancedsettings_colormode_autobalanced, 8, 72);
  gtk_widget_set_size_request (radiobutton_advancedsettings_colormode_autobalanced, 220, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radiobutton_advancedsettings_colormode_autobalanced), radiobutton_advancedsettings_colormode_highcontrast_group);
  radiobutton_advancedsettings_colormode_highcontrast_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radiobutton_advancedsettings_colormode_autobalanced));

  label_advancedsettings_colormode = gtk_label_new (_("Color Code"));
  gtk_widget_show (label_advancedsettings_colormode);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook_advancedsettings), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook_advancedsettings), 1), label_advancedsettings_colormode);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_colormode), GTK_JUSTIFY_LEFT);

  fixed_advancedsettings_comparation = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_comparation);
  gtk_container_add (GTK_CONTAINER (notebook_advancedsettings), fixed_advancedsettings_comparation);

  frame_advancedsettings_cmp_reduction = gtk_frame_new (NULL);
  gtk_widget_show (frame_advancedsettings_cmp_reduction);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_comparation), frame_advancedsettings_cmp_reduction, 8, 0);
  gtk_widget_set_size_request (frame_advancedsettings_cmp_reduction, 368, 72);
  gtk_frame_set_label_align (GTK_FRAME (frame_advancedsettings_cmp_reduction), 0.5, 0.5);

  fixed_advancedsettings_cmp_reduction = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_cmp_reduction);
  gtk_container_add (GTK_CONTAINER (frame_advancedsettings_cmp_reduction), fixed_advancedsettings_cmp_reduction);

  textview_advancedsettings_cmp_reduction = gtk_text_view_new ();
  gtk_widget_show (textview_advancedsettings_cmp_reduction);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_reduction), textview_advancedsettings_cmp_reduction, 120, 8);
  gtk_widget_set_size_request (textview_advancedsettings_cmp_reduction, 224, 40);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_advancedsettings_cmp_reduction), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_advancedsettings_cmp_reduction), FALSE);
  gtk_text_buffer_set_text (gtk_text_view_get_buffer (GTK_TEXT_VIEW (textview_advancedsettings_cmp_reduction)),
	_("All sequence lengths are rescaled to \none million bases for comparison."), -1);

  radio_advancedsettings_cmp_reduction_yes = gtk_radio_button_new_with_mnemonic (NULL, _("Yes"));
  gtk_widget_show (radio_advancedsettings_cmp_reduction_yes);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_reduction), radio_advancedsettings_cmp_reduction_yes, 16, 8);
  gtk_widget_set_size_request (radio_advancedsettings_cmp_reduction_yes, 93, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radio_advancedsettings_cmp_reduction_yes), radio_advancedsettings_cmp_reduction_yes_group);
  radio_advancedsettings_cmp_reduction_yes_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radio_advancedsettings_cmp_reduction_yes));

  radio_advancedsettings_cmp_reduction_no = gtk_radio_button_new_with_mnemonic (NULL, _("No"));
  gtk_widget_show (radio_advancedsettings_cmp_reduction_no);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_reduction), radio_advancedsettings_cmp_reduction_no, 16, 32);
  gtk_widget_set_size_request (radio_advancedsettings_cmp_reduction_no, 93, 20);
  gtk_radio_button_set_group (GTK_RADIO_BUTTON (radio_advancedsettings_cmp_reduction_no), radio_advancedsettings_cmp_reduction_yes_group);
  radio_advancedsettings_cmp_reduction_yes_group = gtk_radio_button_get_group (GTK_RADIO_BUTTON (radio_advancedsettings_cmp_reduction_no));

  text_advancedsettings_cmp_reduction_message = gtk_label_new (_("Normalization"));
  gtk_widget_show (text_advancedsettings_cmp_reduction_message);
  gtk_frame_set_label_widget (GTK_FRAME (frame_advancedsettings_cmp_reduction), text_advancedsettings_cmp_reduction_message);
  gtk_label_set_justify (GTK_LABEL (text_advancedsettings_cmp_reduction_message), GTK_JUSTIFY_LEFT);

  frame_advancedsettings_cmp_display = gtk_frame_new (NULL);
  gtk_widget_show (frame_advancedsettings_cmp_display);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_comparation), frame_advancedsettings_cmp_display, 8, 80);
  gtk_widget_set_size_request (frame_advancedsettings_cmp_display, 368, 136);
  gtk_frame_set_label_align (GTK_FRAME (frame_advancedsettings_cmp_display), 0.5, 0.5);

  fixed_advancedsettings_cmp_display = gtk_fixed_new ();
  gtk_widget_show (fixed_advancedsettings_cmp_display);
  gtk_container_add (GTK_CONTAINER (frame_advancedsettings_cmp_display), fixed_advancedsettings_cmp_display);

  combo_advancedsettings_cmp_DAN = gtk_combo_new ();
  g_object_set_data (G_OBJECT (GTK_COMBO (combo_advancedsettings_cmp_DAN)->popwin),
                     "GladeParentKey", combo_advancedsettings_cmp_DAN);
  gtk_widget_show (combo_advancedsettings_cmp_DAN);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_display), combo_advancedsettings_cmp_DAN, 164, 10);
  gtk_widget_set_size_request (combo_advancedsettings_cmp_DAN, 60, 24);
  combo_advancedsettings_cmp_DAN_items = g_list_append (combo_advancedsettings_cmp_DAN_items, (gpointer) _("4"));
  combo_advancedsettings_cmp_DAN_items = g_list_append (combo_advancedsettings_cmp_DAN_items, (gpointer) _("8"));
  combo_advancedsettings_cmp_DAN_items = g_list_append (combo_advancedsettings_cmp_DAN_items, (gpointer) _("16"));
/*  combo_advancedsettings_cmp_DAN_items = g_list_append (combo_advancedsettings_cmp_DAN_items, (gpointer) _("32")); */
  gtk_combo_set_popdown_strings (GTK_COMBO (combo_advancedsettings_cmp_DAN), combo_advancedsettings_cmp_DAN_items);
  g_list_free (combo_advancedsettings_cmp_DAN_items);

  combo_entry_advancedsettings_cmp_DAN = GTK_COMBO (combo_advancedsettings_cmp_DAN)->entry;
  gtk_widget_show (combo_entry_advancedsettings_cmp_DAN);
  gtk_editable_set_editable (GTK_EDITABLE (combo_entry_advancedsettings_cmp_DAN), FALSE);

  label_advancedsettings_cmp_DARange = gtk_label_new (_("In (0.0 ~ 1.0)"));
  gtk_widget_show (label_advancedsettings_cmp_DARange);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_display), label_advancedsettings_cmp_DARange, 232, 10);
  gtk_widget_set_size_request (label_advancedsettings_cmp_DARange, 88, 24);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_cmp_DARange), GTK_JUSTIFY_LEFT);

  label_advancedsettings_cmp_DAN = gtk_label_new (_("Difference Area Number"));
  gtk_widget_show (label_advancedsettings_cmp_DAN);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings_cmp_display), label_advancedsettings_cmp_DAN, 8, 10);
  gtk_widget_set_size_request (label_advancedsettings_cmp_DAN, 154, 24);
  gtk_label_set_justify (GTK_LABEL (label_advancedsettings_cmp_DAN), GTK_JUSTIFY_LEFT);

  text_advancedsettings_cmp_display = gtk_label_new (_("Difference Precision"));
  gtk_widget_show (text_advancedsettings_cmp_display);
  gtk_frame_set_label_widget (GTK_FRAME (frame_advancedsettings_cmp_display), text_advancedsettings_cmp_display);
  gtk_label_set_justify (GTK_LABEL (text_advancedsettings_cmp_display), GTK_JUSTIFY_LEFT);

  text_advancedsettings_comparation = gtk_label_new (_("Comparison Method"));
  gtk_widget_show (text_advancedsettings_comparation);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook_advancedsettings), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook_advancedsettings), 2), text_advancedsettings_comparation);
  gtk_label_set_justify (GTK_LABEL (text_advancedsettings_comparation), GTK_JUSTIFY_LEFT);

  button_advancedsettings_OK = gtk_button_new_from_stock ("gtk-ok");
  gtk_widget_show (button_advancedsettings_OK);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings), button_advancedsettings_OK, 312, 258);
  gtk_widget_set_size_request (button_advancedsettings_OK, 80, 26);

  button_advancedsettings_CANCEL = gtk_button_new_from_stock ("gtk-cancel");
  gtk_widget_show (button_advancedsettings_CANCEL);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings), button_advancedsettings_CANCEL, 224, 258);
  gtk_widget_set_size_request (button_advancedsettings_CANCEL, 80, 26);

  button_advancedsettings_APPLY = gtk_button_new_from_stock ("gtk-apply");
  gtk_widget_show (button_advancedsettings_APPLY);
  gtk_fixed_put (GTK_FIXED (fixed_advancedsettings), button_advancedsettings_APPLY, 136, 258);
  gtk_widget_set_size_request (button_advancedsettings_APPLY, 80, 26);


  	char 	*colormode_high=NULL;
  	char	*colormode_auto=NULL;
 	colormode_high	=	(char*)g_malloc(320*20*4);
	colormode_auto	= 	(char*)g_malloc(320*20*4);
  	if(colormode_high == NULL || colormode_auto == NULL){
		Memory_Error();
		exit(1);
  	}	
  
  	int colornumber=0,n,m;
	for(colornumber=0;colornumber<16;colornumber++)
  	{	
		for(n=0;n<20;n++){
			for(m=0;m<60;m++){
				colormode_high[(n*320+m/3+colornumber*20)*4+m%3]= color_high[colornumber][m%3]*255;
				colormode_auto[(n*320+m/3+colornumber*20)*4+m%3]= color_auto[colornumber][m%3]*255;
			}
		}
  	}

	color_mode->advancedsettings	=	advancedsettings;	

  g_signal_connect ((gpointer) entry_advancedsettings_random_times, "changed",
                    G_CALLBACK (on_entry_advancedsettings_random_times_changed),
                    entry_advancedsettings_random_times);
  g_signal_connect ((gpointer) drawingarea_advancedsettings_colormode_high, "expose_event",
                    G_CALLBACK (on_drawingarea_advancedsettings_colormode_high_expose_event),
                    colormode_high);
  g_signal_connect ((gpointer) drawingarea_advancedsettings_colormode_auto, "expose_event",
                    G_CALLBACK (on_drawingarea_advancedsettings_colormode_auto_expose_event),
                    colormode_auto);
  g_signal_connect ((gpointer) radiobutton_advancedsettings_colormode_highcontrast, "toggled",
                    G_CALLBACK (on_radiobutton_advancedsettings_colormode_highcontrast_toggled),
                    NULL);
  g_signal_connect ((gpointer) radiobutton_advancedsettings_colormode_autobalanced, "toggled",
                    G_CALLBACK (on_radiobutton_advancedsettings_colormode_autobalanced_toggled),
                    NULL);
  g_signal_connect ((gpointer) radio_advancedsettings_cmp_reduction_yes, "toggled",
                    G_CALLBACK (on_radio_advancedsettings_cmp_reduction_yes_toggled),
                    NULL);
  g_signal_connect ((gpointer) radio_advancedsettings_cmp_reduction_no, "toggled",
                    G_CALLBACK (on_radio_advancedsettings_cmp_reduction_no_toggled),
                    NULL);
  g_signal_connect ((gpointer) combo_entry_advancedsettings_cmp_DAN, "changed",
                    G_CALLBACK (on_combo_entry_advancedsettings_cmp_DAN_changed),
                    combo_entry_advancedsettings_cmp_DAN);
  g_signal_connect ((gpointer) button_advancedsettings_OK, "clicked",
                    G_CALLBACK (on_button_advancedsettings_OK_clicked),
                    color_mode);
  g_signal_connect ((gpointer) button_advancedsettings_CANCEL, "clicked",
                    G_CALLBACK (on_button_advancedsettings_CANCEL_clicked),
                    advancedsettings);
  g_signal_connect ((gpointer) button_advancedsettings_APPLY, "clicked",
                    G_CALLBACK (on_button_advancedsettings_APPLY_clicked),
                    NULL);

  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (advancedsettings, advancedsettings, "advancedsettings");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings, "fixed_advancedsettings");
  GLADE_HOOKUP_OBJECT (advancedsettings, notebook_advancedsettings, "notebook_advancedsettings");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_random, "fixed_advancedsettings_random");
  GLADE_HOOKUP_OBJECT (advancedsettings, frame_advancedsettings_random_times, "frame_advancedsettings_random_times");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_random_times, "fixed_advancedsettings_random_times");
  GLADE_HOOKUP_OBJECT (advancedsettings, combo_advancedsettings_random_times, "combo_advancedsettings_random_times");
  GLADE_HOOKUP_OBJECT (advancedsettings, entry_advancedsettings_random_times, "entry_advancedsettings_random_times");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_random_multiseqlen, "label_advancedsettings_random_multiseqlen");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_randomization, "label_advancedsettings_randomization");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_random_introduction,
"label_advancedsettings_random_introduction");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_colormode, "fixed_advancedsettings_colormode");
  GLADE_HOOKUP_OBJECT (advancedsettings, frame_advancedsettings_colormode, "frame_advancedsettings_colormode");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_colormode_select, "fixed_advancedsettings_colormode_select");
  GLADE_HOOKUP_OBJECT (advancedsettings, drawingarea_advancedsettings_colormode_high, "drawingarea_advancedsettings_colormode_high");
  GLADE_HOOKUP_OBJECT (advancedsettings, drawingarea_advancedsettings_colormode_auto, "drawingarea_advancedsettings_colormode_auto");
  GLADE_HOOKUP_OBJECT (advancedsettings, radiobutton_advancedsettings_colormode_highcontrast, "radiobutton_advancedsettings_colormode_highcontrast");
  GLADE_HOOKUP_OBJECT (advancedsettings, radiobutton_advancedsettings_colormode_autobalanced, "radiobutton_advancedsettings_colormode_autobalanced");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_colormode, "label_advancedsettings_colormode");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_comparation, "fixed_advancedsettings_comparation");
  GLADE_HOOKUP_OBJECT (advancedsettings, frame_advancedsettings_cmp_reduction, "frame_advancedsettings_cmp_reduction");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_cmp_reduction, "fixed_advancedsettings_cmp_reduction");
  GLADE_HOOKUP_OBJECT (advancedsettings, textview_advancedsettings_cmp_reduction, "textview_advancedsettings_cmp_reduction");
  GLADE_HOOKUP_OBJECT (advancedsettings, radio_advancedsettings_cmp_reduction_yes, "radio_advancedsettings_cmp_reduction_yes");
  GLADE_HOOKUP_OBJECT (advancedsettings, radio_advancedsettings_cmp_reduction_no, "radio_advancedsettings_cmp_reduction_no");
  GLADE_HOOKUP_OBJECT (advancedsettings, text_advancedsettings_cmp_reduction_message, "text_advancedsettings_cmp_reduction_message");
  GLADE_HOOKUP_OBJECT (advancedsettings, frame_advancedsettings_cmp_display, "frame_advancedsettings_cmp_display");
  GLADE_HOOKUP_OBJECT (advancedsettings, fixed_advancedsettings_cmp_display, "fixed_advancedsettings_cmp_display");
  GLADE_HOOKUP_OBJECT (advancedsettings, combo_advancedsettings_cmp_DAN, "combo_advancedsettings_cmp_DAN");
  GLADE_HOOKUP_OBJECT (advancedsettings, combo_entry_advancedsettings_cmp_DAN, "combo_entry_advancedsettings_cmp_DAN");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_cmp_DARange, "label_advancedsettings_cmp_DARange");
  GLADE_HOOKUP_OBJECT (advancedsettings, label_advancedsettings_cmp_DAN, "label_advancedsettings_cmp_DAN");
  GLADE_HOOKUP_OBJECT (advancedsettings, text_advancedsettings_cmp_display, "text_advancedsettings_cmp_display");
  GLADE_HOOKUP_OBJECT (advancedsettings, text_advancedsettings_comparation, "text_advancedsettings_comparation");
  GLADE_HOOKUP_OBJECT (advancedsettings, button_advancedsettings_OK, "button_advancedsettings_OK");
  GLADE_HOOKUP_OBJECT (advancedsettings, button_advancedsettings_CANCEL, "button_advancedsettings_CANCEL");
  GLADE_HOOKUP_OBJECT (advancedsettings, button_advancedsettings_APPLY, "button_advancedsettings_APPLY");

  return advancedsettings;
}

GtkWidget*
create_comparation (Portrait *HEAD,Portrait *current_portrait)
{
  
  GtkWidget *comparation;
  GtkWidget *compresult;
  
  GtkWidget *fixed_comparation;
  GtkWidget *button_comparation_OK;
  GtkWidget *alignment_cmp_OK;
  GtkWidget *hbox_cmp_OK;
  GtkWidget *image_cmp_OK;
  GtkWidget *label_cmp_OK;
  GtkWidget *button_comparation_Cancel;
  GtkWidget *alignment_cmp_Cancel;
  GtkWidget *hbox_cmp_Cancel;
  GtkWidget *image_cmp_Cancel;
  GtkWidget *label_cmp_Cancel;
  GtkWidget *frame_comparation_destination;
  GtkWidget *fixed_comparation_destination;
  GtkWidget *scrolledwindow_comparation_destination;
  GtkWidget *clist_comparation_destination;
  GtkWidget *label_comparation_destination_portraitID;
  GtkWidget *label_comparation_destination_Description;
  GtkWidget *label_comparation_destination;
  GtkWidget *frame_comparation_current;
  GtkWidget *fixed_comparation_current;
  GtkWidget *label_comparation_current_Description;
  GtkWidget *label_comparation_current_portraitID;
  GtkWidget *textview_comparation_current_portraitID;
  GtkWidget *textview_comparation_current_Description;
  GtkWidget *label_comparation_current;

  comparation = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_widget_set_size_request (comparation, 400, 300);
  gtk_window_set_position (GTK_WINDOW (comparation), GTK_WIN_POS_CENTER);
  gtk_window_set_modal (GTK_WINDOW (comparation), TRUE);
  gtk_window_set_title (GTK_WINDOW (comparation), _("Comparation"));
  gtk_window_set_resizable (GTK_WINDOW (comparation), FALSE);

  fixed_comparation = gtk_fixed_new ();
  gtk_widget_show (fixed_comparation);
  gtk_container_add (GTK_CONTAINER (comparation), fixed_comparation);
  gtk_widget_set_size_request (fixed_comparation, 392, 290);

  button_comparation_OK = gtk_button_new ();
  gtk_widget_show (button_comparation_OK);
  gtk_fixed_put (GTK_FIXED (fixed_comparation), button_comparation_OK, 290, 263);
  gtk_widget_set_size_request (button_comparation_OK, 100, 26);

  alignment_cmp_OK = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_cmp_OK);
  gtk_container_add (GTK_CONTAINER (button_comparation_OK), alignment_cmp_OK);

  hbox_cmp_OK = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_cmp_OK);
  gtk_container_add (GTK_CONTAINER (alignment_cmp_OK), hbox_cmp_OK);

  image_cmp_OK = gtk_image_new_from_stock ("gtk-ok", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_cmp_OK);
  gtk_box_pack_start (GTK_BOX (hbox_cmp_OK), image_cmp_OK, FALSE, FALSE, 0);

  label_cmp_OK = gtk_label_new_with_mnemonic (_("OK"));
  gtk_widget_show (label_cmp_OK);
  gtk_box_pack_start (GTK_BOX (hbox_cmp_OK), label_cmp_OK, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_cmp_OK), GTK_JUSTIFY_LEFT);

  button_comparation_Cancel = gtk_button_new ();
  gtk_widget_show (button_comparation_Cancel);
  gtk_fixed_put (GTK_FIXED (fixed_comparation), button_comparation_Cancel, 180, 263);
  gtk_widget_set_size_request (button_comparation_Cancel, 100, 26);

  alignment_cmp_Cancel = gtk_alignment_new (0.5, 0.5, 0, 0);
  gtk_widget_show (alignment_cmp_Cancel);
  gtk_container_add (GTK_CONTAINER (button_comparation_Cancel), alignment_cmp_Cancel);

  hbox_cmp_Cancel = gtk_hbox_new (FALSE, 2);
  gtk_widget_show (hbox_cmp_Cancel);
  gtk_container_add (GTK_CONTAINER (alignment_cmp_Cancel), hbox_cmp_Cancel);

  image_cmp_Cancel = gtk_image_new_from_stock ("gtk-cancel", GTK_ICON_SIZE_BUTTON);
  gtk_widget_show (image_cmp_Cancel);
  gtk_box_pack_start (GTK_BOX (hbox_cmp_Cancel), image_cmp_Cancel, FALSE, FALSE, 0);

  label_cmp_Cancel = gtk_label_new_with_mnemonic (_("Cancel"));
  gtk_widget_show (label_cmp_Cancel);
  gtk_box_pack_start (GTK_BOX (hbox_cmp_Cancel), label_cmp_Cancel, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label_cmp_Cancel), GTK_JUSTIFY_LEFT);

  frame_comparation_destination = gtk_frame_new (NULL);
  gtk_widget_show (frame_comparation_destination);
  gtk_fixed_put (GTK_FIXED (fixed_comparation), frame_comparation_destination, 8, 80);
  gtk_widget_set_size_request (frame_comparation_destination, 384, 180);
  gtk_frame_set_label_align (GTK_FRAME (frame_comparation_destination), 0.5, 0.5);

  fixed_comparation_destination = gtk_fixed_new ();
  gtk_widget_show (fixed_comparation_destination);
  gtk_container_add (GTK_CONTAINER (frame_comparation_destination), fixed_comparation_destination);

  scrolledwindow_comparation_destination = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_show (scrolledwindow_comparation_destination);
  gtk_fixed_put (GTK_FIXED (fixed_comparation_destination), scrolledwindow_comparation_destination, 8, 4);
  gtk_widget_set_size_request (scrolledwindow_comparation_destination, 364, 154);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow_comparation_destination), GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);

  clist_comparation_destination = gtk_clist_new (2);
  gtk_widget_show (clist_comparation_destination);
  gtk_container_add (GTK_CONTAINER (scrolledwindow_comparation_destination), clist_comparation_destination);
  gtk_widget_set_size_request (clist_comparation_destination, 339, 129);
  gtk_clist_set_column_width (GTK_CLIST (clist_comparation_destination), 0, 120);
  gtk_clist_set_column_width (GTK_CLIST (clist_comparation_destination), 1, 100);
  gtk_clist_column_titles_show (GTK_CLIST (clist_comparation_destination));

  label_comparation_destination_portraitID = gtk_label_new (_("Portrait ID"));
  gtk_widget_show (label_comparation_destination_portraitID);
  gtk_clist_set_column_widget (GTK_CLIST (clist_comparation_destination), 0, label_comparation_destination_portraitID);
  gtk_widget_set_size_request (label_comparation_destination_portraitID, 80, 16);
  gtk_label_set_justify (GTK_LABEL (label_comparation_destination_portraitID), GTK_JUSTIFY_LEFT);

  label_comparation_destination_Description = gtk_label_new (_("Portrait Description"));
  gtk_widget_show (label_comparation_destination_Description);
  gtk_clist_set_column_widget (GTK_CLIST (clist_comparation_destination), 1, label_comparation_destination_Description);
  gtk_label_set_justify (GTK_LABEL (label_comparation_destination_Description), GTK_JUSTIFY_LEFT);

  label_comparation_destination = gtk_label_new (_("Target Portrait"));
  gtk_widget_show (label_comparation_destination);
  gtk_frame_set_label_widget (GTK_FRAME (frame_comparation_destination), label_comparation_destination);
  gtk_label_set_justify (GTK_LABEL (label_comparation_destination), GTK_JUSTIFY_LEFT);

  frame_comparation_current = gtk_frame_new (NULL);
  gtk_widget_show (frame_comparation_current);
  gtk_fixed_put (GTK_FIXED (fixed_comparation), frame_comparation_current, 8, 8);
  gtk_widget_set_size_request (frame_comparation_current, 384, 64);
  gtk_frame_set_label_align (GTK_FRAME (frame_comparation_current), 0.5, 0.5);

  fixed_comparation_current = gtk_fixed_new ();
  gtk_widget_show (fixed_comparation_current);
  gtk_container_add (GTK_CONTAINER (frame_comparation_current), fixed_comparation_current);

  label_comparation_current_Description = gtk_label_new (_("Portrait Description"));
  gtk_widget_show (label_comparation_current_Description);
  gtk_fixed_put (GTK_FIXED (fixed_comparation_current), label_comparation_current_Description, 128, 4);
  gtk_widget_set_size_request (label_comparation_current_Description, 244, 16);
  gtk_label_set_justify (GTK_LABEL (label_comparation_current_Description), GTK_JUSTIFY_LEFT);

  label_comparation_current_portraitID = gtk_label_new (_("Portrait ID"));
  gtk_widget_show (label_comparation_current_portraitID);
  gtk_fixed_put (GTK_FIXED (fixed_comparation_current), label_comparation_current_portraitID, 8, 4);
  gtk_widget_set_size_request (label_comparation_current_portraitID, 100, 16);
  gtk_label_set_justify (GTK_LABEL (label_comparation_current_portraitID), GTK_JUSTIFY_LEFT);

  textview_comparation_current_portraitID = gtk_text_view_new ();
  gtk_widget_show (textview_comparation_current_portraitID);
  gtk_fixed_put (GTK_FIXED (fixed_comparation_current), textview_comparation_current_portraitID, 8, 22);
  gtk_widget_set_size_request (textview_comparation_current_portraitID, 104, 20);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_comparation_current_portraitID), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_comparation_current_portraitID), FALSE);

  textview_comparation_current_Description = gtk_text_view_new ();
  gtk_widget_show (textview_comparation_current_Description);
  gtk_fixed_put (GTK_FIXED (fixed_comparation_current), textview_comparation_current_Description, 120, 22);
  gtk_widget_set_size_request (textview_comparation_current_Description, 250, 20);
  gtk_text_view_set_editable (GTK_TEXT_VIEW (textview_comparation_current_Description), FALSE);
  gtk_text_view_set_cursor_visible (GTK_TEXT_VIEW (textview_comparation_current_Description), FALSE);

  label_comparation_current = gtk_label_new (_("Current Portrait"));
  gtk_widget_show (label_comparation_current);
  gtk_frame_set_label_widget (GTK_FRAME (frame_comparation_current), label_comparation_current);
  gtk_label_set_justify (GTK_LABEL (label_comparation_current), GTK_JUSTIFY_LEFT);

	gchar *text[2];
	int n;
	Portrait *temp=HEAD;
	for(;;){
		if(temp != NULL){
			text[0] = temp->ID;
			text[1] = temp->Description;
			if(	temp->marker != current_portrait->marker){ 
				if(	temp->portrait_settings->k_tuples == 
					current_portrait->portrait_settings->k_tuples)
 						gtk_clist_append((GtkCList*)clist_comparation_destination,text);
 			}
  			else{
  			  	gtk_text_buffer_set_text (gtk_text_view_get_buffer (
					GTK_TEXT_VIEW (textview_comparation_current_portraitID)),text[0], -1);
				gtk_text_buffer_set_text (gtk_text_view_get_buffer (
					GTK_TEXT_VIEW (textview_comparation_current_Description)),text[1], -1);
  			}
  			temp = (Portrait*)temp->next;
  		}
  		else
  			break;
  	}

  	typedef struct _ComparationBox{
		GtkWidget 	*comparation_window;	
		Portrait	*current;
  	} ComparationBox;
  
  ComparationBox *com_box = (ComparationBox*)g_malloc(sizeof(ComparationBox));
  com_box->comparation_window = comparation;
  com_box->current = current_portrait;
  
  g_signal_connect ((gpointer) button_comparation_OK, "clicked",
                    G_CALLBACK (on_button_comparation_OK_clicked),
                    com_box);
  g_signal_connect ((gpointer) button_comparation_Cancel, "clicked",
                    G_CALLBACK (on_button_comparation_Cancel_clicked),
                    comparation);
  g_signal_connect ((gpointer) clist_comparation_destination, "select_row",
                    G_CALLBACK (on_clist_comparation_destination_select_row),
                    com_box);

  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (comparation, comparation, "comparation");
  GLADE_HOOKUP_OBJECT (comparation, fixed_comparation, "fixed_comparation");
  GLADE_HOOKUP_OBJECT (comparation, button_comparation_OK, "button_comparation_OK");
  GLADE_HOOKUP_OBJECT (comparation, alignment_cmp_OK, "alignment_cmp_OK");
  GLADE_HOOKUP_OBJECT (comparation, hbox_cmp_OK, "hbox_cmp_OK");
  GLADE_HOOKUP_OBJECT (comparation, image_cmp_OK, "image_cmp_OK");
  GLADE_HOOKUP_OBJECT (comparation, label_cmp_OK, "label_cmp_OK");
  GLADE_HOOKUP_OBJECT (comparation, button_comparation_Cancel, "button_comparation_Cancel");
  GLADE_HOOKUP_OBJECT (comparation, alignment_cmp_Cancel, "alignment_cmp_Cancel");
  GLADE_HOOKUP_OBJECT (comparation, hbox_cmp_Cancel, "hbox_cmp_Cancel");
  GLADE_HOOKUP_OBJECT (comparation, image_cmp_Cancel, "image_cmp_Cancel");
  GLADE_HOOKUP_OBJECT (comparation, label_cmp_Cancel, "label_cmp_Cancel");
  GLADE_HOOKUP_OBJECT (comparation, frame_comparation_destination, "frame_comparation_destination");
  GLADE_HOOKUP_OBJECT (comparation, fixed_comparation_destination, "fixed_comparation_destination");
  GLADE_HOOKUP_OBJECT (comparation, scrolledwindow_comparation_destination, "scrolledwindow_comparation_destination");
  GLADE_HOOKUP_OBJECT (comparation, clist_comparation_destination, "clist_comparation_destination");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_destination_portraitID, "label_comparation_destination_portraitID");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_destination_Description, "label_comparation_destination_Description");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_destination, "label_comparation_destination");
  GLADE_HOOKUP_OBJECT (comparation, frame_comparation_current, "frame_comparation_current");
  GLADE_HOOKUP_OBJECT (comparation, fixed_comparation_current, "fixed_comparation_current");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_current_Description, "label_comparation_current_Description");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_current_portraitID, "label_comparation_current_portraitID");
  GLADE_HOOKUP_OBJECT (comparation, textview_comparation_current_portraitID, "textview_comparation_current_portraitID");
  GLADE_HOOKUP_OBJECT (comparation, textview_comparation_current_Description, "textview_comparation_current_Description");
  GLADE_HOOKUP_OBJECT (comparation, label_comparation_current, "label_comparation_current");

  return comparation;
}

GtkWidget*
create_about (void)
{
  GtkWidget *about;
  GtkWidget *fixed_about;
  GtkWidget *hseparator_about;
  GtkWidget *image_about;
  GtkWidget *label_about;
  GtkWidget *label_about_introduction;
  GtkWidget *label_about_copyleft;
  GtkWidget *button_about;

  about = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_widget_set_size_request (about, 360, 200);
  gtk_window_set_position (GTK_WINDOW (about), GTK_WIN_POS_CENTER); 
  gtk_window_set_title (GTK_WINDOW (about), _("About SeeDNA"));
  gtk_window_set_default_size (GTK_WINDOW (about), 360, 200);
  gtk_window_set_resizable (GTK_WINDOW (about), FALSE);

  fixed_about = gtk_fixed_new ();
  gtk_widget_show (fixed_about);
  gtk_container_add (GTK_CONTAINER (about), fixed_about);

  hseparator_about = gtk_hseparator_new ();
  gtk_widget_show (hseparator_about);
  gtk_fixed_put (GTK_FIXED (fixed_about), hseparator_about, 0, 152);
  gtk_widget_set_size_request (hseparator_about, 360, 16);

  image_about = gtk_image_new_from_stock ("gnome-stock-about", GTK_ICON_SIZE_DIALOG);
  gtk_widget_show (image_about);
  gtk_fixed_put (GTK_FIXED (fixed_about), image_about, 128, 16);
  gtk_widget_set_size_request (image_about, 100, 50);

  label_about = gtk_label_new (_("SeeDNA 1.0"));
  gtk_widget_show (label_about);
  gtk_fixed_put (GTK_FIXED (fixed_about), label_about, 120, 72);
  gtk_widget_set_size_request (label_about, 112, 24);

  label_about_introduction = gtk_label_new (_("SeeDNA displays the K-string composition of a DNA \nsequences in one- and two-dimensional histograms."));
  gtk_widget_show (label_about_introduction);
  gtk_fixed_put (GTK_FIXED (fixed_about), label_about_introduction, 24, 96);
  gtk_widget_set_size_request (label_about_introduction, 312, 40);
  gtk_label_set_justify (GTK_LABEL (label_about_introduction), GTK_JUSTIFY_LEFT);

  label_about_copyleft = gtk_label_new (_("(c) 2003 Shen,Lee,Zhang,Hao"));
  gtk_widget_show (label_about_copyleft);
  gtk_fixed_put (GTK_FIXED (fixed_about), label_about_copyleft, 80, 136);
  gtk_widget_set_size_request (label_about_copyleft, 192, 16);
  gtk_label_set_justify (GTK_LABEL (label_about_copyleft), GTK_JUSTIFY_LEFT);

  button_about = gtk_button_new_from_stock ("gtk-ok");
  gtk_widget_show (button_about);
  gtk_fixed_put (GTK_FIXED (fixed_about), button_about, 270, 166);
  gtk_widget_set_size_request (button_about, 80, 28);

  g_signal_connect ((gpointer) button_about, "clicked",
                    G_CALLBACK (on_button_about_clicked),
                    about);

  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (about, about, "about");
  GLADE_HOOKUP_OBJECT (about, fixed_about, "fixed_about");
  GLADE_HOOKUP_OBJECT (about, hseparator_about, "hseparator_about");
  GLADE_HOOKUP_OBJECT (about, image_about, "image_about");
  GLADE_HOOKUP_OBJECT (about, label_about, "label_about");
  GLADE_HOOKUP_OBJECT (about, label_about_introduction, "label_about_introduction");
  GLADE_HOOKUP_OBJECT (about, label_about_copyleft, "label_about_copyleft");
  GLADE_HOOKUP_OBJECT (about, button_about, "button_about");

  return about;
}

GtkWidget*
create_error (int error_type,char *message)
{
  GtkWidget *error;
  GtkWidget *dialog_vbox_error;
  GtkWidget *fixed_error;
  GtkWidget *label_error;
  GtkWidget *image_error;
  GtkWidget *dialog_action_area_error;
  GtkWidget *okbutton_error;

  error = gtk_dialog_new ();
  gtk_widget_set_size_request (error, 250, 120);
	switch(error_type){
		case ERROR: 	gtk_window_set_title (GTK_WINDOW (error), _("Error"));
				break;
		case WARNING: 	gtk_window_set_title (GTK_WINDOW (error), _("WARNING"));				
				break;
 	}
  gtk_window_set_title (GTK_WINDOW (error), _("Error"));
//  gtk_window_set_default_size (GTK_WINDOW (error), 300, 200);
  gtk_window_set_position (GTK_WINDOW (error), GTK_WIN_POS_CENTER);
  gtk_window_set_modal (GTK_WINDOW (error), TRUE);
  gtk_window_set_resizable (GTK_WINDOW (error), FALSE);



  dialog_vbox_error = GTK_DIALOG (error)->vbox;
  gtk_widget_show (dialog_vbox_error);

  fixed_error = gtk_fixed_new ();
  gtk_widget_show (fixed_error);
  gtk_box_pack_start (GTK_BOX (dialog_vbox_error), fixed_error, TRUE, TRUE, 0);

  label_error = gtk_label_new (message);
  gtk_widget_show (label_error);
  gtk_fixed_put (GTK_FIXED (fixed_error), label_error, 70, 8);
  gtk_widget_set_size_request (label_error, 180, 40);
  gtk_label_set_justify (GTK_LABEL (label_error), GTK_JUSTIFY_LEFT);

	switch(error_type){
		case 1: 
				image_error=gtk_image_new_from_stock ("gtk-dialog-error", GTK_ICON_SIZE_DIALOG);
 				break;
		
		case 2: 
				image_error=gtk_image_new_from_stock ("gtk-dialog-warning", GTK_ICON_SIZE_DIALOG);
				break;
 	}
  gtk_widget_show (image_error);
  gtk_fixed_put (GTK_FIXED (fixed_error), image_error, 10, 8);
  gtk_widget_set_size_request (image_error, 56, 48);

  dialog_action_area_error = GTK_DIALOG (error)->action_area;
  gtk_widget_show (dialog_action_area_error);
  gtk_button_box_set_layout (GTK_BUTTON_BOX (dialog_action_area_error), GTK_BUTTONBOX_END);

  okbutton_error = gtk_button_new_from_stock ("gtk-ok");
  gtk_widget_show (okbutton_error);
  gtk_dialog_add_action_widget (GTK_DIALOG (error), okbutton_error, GTK_RESPONSE_OK);
  GTK_WIDGET_SET_FLAGS (okbutton_error, GTK_CAN_DEFAULT);

  g_signal_connect ((gpointer) okbutton_error, "clicked",
                    G_CALLBACK (on_okbutton_error_clicked),
                    error);

  /* Store pointers to all widgets, for use by lookup_widget(). */
  GLADE_HOOKUP_OBJECT_NO_REF (error, error, "error");
  GLADE_HOOKUP_OBJECT_NO_REF (error, dialog_vbox_error, "dialog_vbox_error");
  GLADE_HOOKUP_OBJECT (error, fixed_error, "fixed_error");
  GLADE_HOOKUP_OBJECT (error, label_error, "label_error");
  GLADE_HOOKUP_OBJECT (error, image_error, "image_error");
  GLADE_HOOKUP_OBJECT_NO_REF (error, dialog_action_area_error, "dialog_action_area_error");
  GLADE_HOOKUP_OBJECT (error, okbutton_error, "okbutton_error");

  return error;
}
